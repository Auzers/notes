<!DOCTYPE html><html class=no-js lang=zh> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content=这里是amaranth的博客 name=description><meta content=amaranth name=author><link href=https://Auzers.github.io/notes/ai/ml/wedml/ rel=canonical><link href=../../ rel=prev><link href=../../aitools/numpy/ rel=next><link href=../../../assets/images/logo1.png rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.5.49" name=generator><title>课程笔记 - amaranth 的 叶栈漫谈</title><link href=../../../assets/stylesheets/main.6f8fc17f.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><style>:root{--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M320 96a32 32 0 1 1-64 0 32 32 0 1 1 64 0m21.1 80C367 158.8 384 129.4 384 96c0-53-43-96-96-96s-96 43-96 96c0 33.4 17 62.8 42.9 80H224c-17.7 0-32 14.3-32 32s14.3 32 32 32h32v208h-48c-53 0-96-43-96-96v-6.1l7 7c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L97 263c-9.4-9.4-24.6-9.4-33.9 0L7 319c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l7-7v6.1c0 88.4 71.6 160 160 160h160c88.4 0 160-71.6 160-160v-6.1l7 7c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-56-56c-9.4-9.4-24.6-9.4-33.9 0l-56 56c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l7-7v6.1c0 53-43 96-96 96h-48V240h32c17.7 0 32-14.3 32-32s-14.3-32-32-32h-10.9z"/></svg>');--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="m368.4 18.3-55.7 55.8 125.2 125.2 55.7-55.7c21.9-21.9 21.9-57.3 0-79.2l-46-46.1c-21.9-21.9-57.3-21.9-79.2 0M288 94.6l-9.2 2.8-144.1 43.2c-19.9 6-35.7 21.2-42.3 41L3.8 445.8c-3.8 11.3-1 23.9 7.3 32.4l153.6-153.5c-3-6.3-4.7-13.3-4.7-20.7 0-26.5 21.5-48 48-48s48 21.5 48 48-21.5 48-48 48c-7.4 0-14.4-1.7-20.7-4.7L33.7 500.9c8.6 8.3 21.1 11.2 32.4 7.3l264.3-88.6c19.7-6.6 35-22.4 41-42.3l43.2-144.1 2.7-9.2z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M40 48c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24zm152 16c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zM16 232v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24m24 136c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2 5.2-7.1 10.4-14.2 15.4-21.4 19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3 5 7.2 10.2 14.3 15.4 21.4 19.8 27.1 39.7 54.4 49.2 86.2h160zm-80 128c44.2 0 80-35.8 80-80v-16H112v16c0 44.2 35.8 80 80 80m-80-336c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112 8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1-64 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32m0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24m32 224a32 32 0 1 0-64 0 32 32 0 1 0 64 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3c4.97 0 9 3.58 9 8s-6 10-9 10-9-5.58-9-10 4.03-8 9-8m-1.69 7.93C9.29 9.29 7.47 8.58 6.25 9.34s-1.38 2.71-.36 4.35c1.03 1.64 2.85 2.35 4.07 1.59 1.22-.78 1.37-2.71.35-4.35m3.38 0c-1.02 1.64-.87 3.57.35 4.35 1.22.76 3.04.05 4.07-1.59 1.02-1.64.86-3.59-.36-4.35s-3.04-.05-4.06 1.59M12 17.75c-2 0-2.5-.75-2.5-.75 0 .03.5 2 2.5 2s2.5-2 2.5-2-.5.75-2.5.75"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v11.5c0 49.9-60.3 74.9-95.6 39.6l-8.2-8.1C107.7 62.5 87.5 62.5 75 75s-12.5 32.8 0 45.3l8.2 8.2c35.2 35.2 10.2 95.5-39.7 95.5H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h11.5c49.9 0 74.9 60.3 39.6 95.6l-8.1 8.2c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l8.2-8.2c35.3-35.3 95.6-10.3 95.6 39.6V480c0 17.7 14.3 32 32 32s32-14.3 32-32v-11.5c0-49.9 60.3-74.9 95.6-39.6l8.2 8.2c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-8.2-8.2c-35.3-35.3-10.3-95.6 39.6-95.6h11.5c17.7 0 32-14.3 32-32s-14.3-32-32-32h-11.5c-49.9 0-74.9-60.3-39.6-95.6l8.2-8.2c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-8.2 8.2C348.3 118.4 288 93.4 288 43.5zM176 224a48 48 0 1 1 96 0 48 48 0 1 1-96 0m128 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32M208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0m152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80M48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48m544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6 31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5 50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5l112.2-112.3c31.5-31.5 82.5-31.5 114 0 27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0z"/></svg>');}</style><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono"}</style><link href=../../../css/heti.css rel=stylesheet><link href=../../../css/toc_extra.css rel=stylesheet><link href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css rel=stylesheet><link href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css rel=stylesheet><link href=https://cdn.tonycrane.cc/jbmono/jetbrainsmono.css rel=stylesheet><link href=https://cdn.tonycrane.cc/lxgw/lxgwscreen.css rel=stylesheet><link href=../../../css/custom.min.css rel=stylesheet><link href=../../../css/tasklist.min.css rel=stylesheet><link href=../../../css/card.min.css rel=stylesheet><link href=../../../css/flink.min.css rel=stylesheet><link href=../../../css/fold_toc.min.css rel=stylesheet><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><style>/* 自定义分隔线样式 */
hr.custom-hr {
    position: relative;
    text-align: center;
    border: 0;
    height: 1px;
    background: none;
    /* 使用主题的边框颜色 */
    border-top: 2px solid var(--md-default-fg-color--lighter, currentColor);
    margin: 100px 0 !important;
}

hr.custom-hr:before {
    content: attr(data-content);
    position: absolute;
    /* 使用主题的背景色，fallback 到页面背景色 */
    background: var(--md-default-bg-color, var(--md-primary-bg-color, inherit));
    /* 使用主题的文本颜色 */
    color: var(--md-default-fg-color, currentColor);
    padding: 0 0.5em;
    line-height: 1;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2em;
    font-weight: bold;
}

/* 目录中分隔线条目的样式 */
.md-nav__item.hr-nav-item {
    text-align: center;
    margin: 1.16em 0;
    /* 增加上下间距 */
}

.md-nav__item.hr-nav-item .md-nav__link {
    justify-content: center;
    font-weight: bold;
    font-size: 1.1em;
    color: var(--md-typeset-color) !important;
}

/* 悬停效果 */
.md-nav__item.hr-nav-item .md-nav__link:hover {
    color: var(--md-accent-fg-color) !important;
}

/* 修改分隔线的样式 */
.md-content__inner hr.custom-hr {
    border: none !important;
    height: 2px !important;
    background-color: var(--md-typeset-color) !important;
    margin: 8em 0 !important;
    /* 增加分隔线的上下间距 */
}

/* 确保分隔线文字可见 */
.md-content__inner hr.custom-hr[data-content]::before {
    color: var(--md-typeset-color) !important;
}</style><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=default dir=ltr> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#ng-machine-learning> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav aria-label=页眉 class="md-header__inner md-grid"> <a aria-label="amaranth 的 叶栈漫谈" class="md-header__button md-logo" data-md-component=logo href=../../.. title="amaranth 的 叶栈漫谈"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> amaranth 的 叶栈漫谈 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 课程笔记 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="follow system" class=md-option data-md-color-accent=indigo data-md-color-media=(prefers-color-scheme) data-md-color-primary=indigo data-md-color-scheme=default id=__palette_0 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="follow system"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg> </label> <input aria-label="light mode" class=md-option data-md-color-accent=indigo data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary=pink data-md-color-scheme=default id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_2 hidden title="light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input aria-label=darkmode class=md-option data-md-color-accent=indigo data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary=black data-md-color-scheme=slate id=__palette_2 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_0 hidden title=darkmode> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=搜索 autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=搜索 required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label=查找 class=md-search__options> <a aria-label=分享 class="md-search__icon md-icon" data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=分享> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button aria-label=清空当前内容 class="md-search__icon md-icon" tabindex=-1 title=清空当前内容 type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix tabindex=0> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/Auzers/notes/ title=前往仓库> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg> </div> <div class=md-source__repository> amaranth's site </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav aria-label=标签 class=md-tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg> Home </a> </li> <li class=md-tabs__item> <a href=../../../computer/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"></path></svg> Computer Science </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> AI </a> </li> <li class=md-tabs__item> <a href=../../../tools/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16h-2v-1H8v1H6v-1H2v5h20v-5h-4zm2-8h-3V6c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v4h4v-2h2v2h8v-2h2v2h4v-4c0-1.1-.9-2-2-2m-5 0H9V6h6z"></path></svg> Else </a> </li> <li class=md-tabs__item> <a href=../../../summary/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M6 1h2v2h8V1h2v2h1a2 2 0 0 1 2 2v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.11.89-2 2-2h1zM5 8v11h14V8zm2 2h10v2H7z"></path></svg> Summary </a> </li> <li class=md-tabs__item> <a href=../../../Blogs/ class=md-tabs__link> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"></path></svg> Blogs </a> </li> <li class=md-tabs__item> <a href=../../../tags/ class=md-tabs__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg> Tags </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=导航栏 class="md-nav md-nav--primary md-nav--lifted" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label="amaranth 的 叶栈漫谈" class="md-nav__button md-logo" data-md-component=logo href=../../.. title="amaranth 的 叶栈漫谈"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8"></path></svg> </a> amaranth 的 叶栈漫谈 </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/Auzers/notes/ title=前往仓库> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg> </div> <div class=md-source__repository> amaranth's site </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_1 type=checkbox> <div class="md-nav__link md-nav__container"> <a class=md-nav__link href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg> <span class=md-ellipsis> Home </span> </a> </div> <nav aria-expanded=false aria-labelledby=__nav_1_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../computer/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"></path></svg> <span class=md-ellipsis> Computer Science </span> </a> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_2_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Computer Science </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2_2 type=checkbox> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> CS61A </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> CS61A </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../computer/CS61A/CS61A_notes/ class=md-nav__link> <span class=md-ellipsis> CS61A_notes </span> </a> </li> <li class=md-nav__item> <a href=../../../computer/CS61A/CS61A_resource/ class=md-nav__link> <span class=md-ellipsis> something related </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2_3 type=checkbox> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Data Structure </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_3_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Data Structure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../computer/Algorithm/algorithm/ class=md-nav__link> <span class=md-ellipsis> Basis of algorithm </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2_4 type=checkbox> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> CSAPP </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_4_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> CSAPP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../computer/CSAPP/resource/ class=md-nav__link> <span class=md-ellipsis> Resource </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2_5 type=checkbox> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class=md-ellipsis> C语言 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_5_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> C语言 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../computer/C/learning_c/ class=md-nav__link> <span class=md-ellipsis> C语言 </span> </a> </li> <li class=md-nav__item> <a href=../../../computer/C/scatter/ class=md-nav__link> <span class=md-ellipsis> something scattered </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2_6 type=checkbox> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class=md-ellipsis> C++ </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_6_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../computer/C%2B%2B/ac_cpp/ class=md-nav__link> <span class=md-ellipsis> 速成 C++ </span> </a> </li> <li class=md-nav__item> <a href=../../../computer/C%2B%2B/C%2B%2B/ class=md-nav__link> <span class=md-ellipsis> C++ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2_7 type=checkbox> <label class=md-nav__link for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_7_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../computer/Linux/linux2/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_3 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> <span class=md-ellipsis> AI </span> </a> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=true aria-labelledby=__nav_3_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> AI </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_3_2 type=checkbox> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Ng-machine learning </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=true aria-labelledby=__nav_3_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Ng-machine learning </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 课程笔记 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 课程笔记 </span> </a> <nav aria-label=目录 class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#0> <span class=md-ellipsis> 0 什么是机器学习 </span> </a> <nav aria-label="0 什么是机器学习" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#_1> <span class=md-ellipsis> 监督学习 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#_2> <span class=md-ellipsis> 无监督学习 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#1> <span class=md-ellipsis> 1 线性回归 </span> </a> <nav aria-label="1 线性回归" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#11> <span class=md-ellipsis> 1.1 成本函数 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#12> <span class=md-ellipsis> 1.2 梯度下降 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#13> <span class=md-ellipsis> 1.3 梯度下降代码实现 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#2> <span class=md-ellipsis> 2 多元线性回归 </span> </a> <nav aria-label="2 多元线性回归" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#21> <span class=md-ellipsis> 2.1 向量化 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#22> <span class=md-ellipsis> 2.2 多元梯度下降 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#23> <span class=md-ellipsis> 2.3 多元梯度下降代码实现 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#24> <span class=md-ellipsis> 2.4 特征缩放 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#25-z-score> <span class=md-ellipsis> 2.5 z-score 归一化代码实现 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#26> <span class=md-ellipsis> 2.6 特征工程和多项式回归 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#3> <span class=md-ellipsis> 3 逻辑回归 </span> </a> <nav aria-label="3 逻辑回归" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#31> <span class=md-ellipsis> 3.1 决策边界 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#32> <span class=md-ellipsis> 3.2 逻辑回归的成本函数 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#33> <span class=md-ellipsis> 3.3 将梯度下降应用到逻辑回归 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#34> <span class=md-ellipsis> 3.4 过拟合 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#35> <span class=md-ellipsis> 3.5 解决过拟合 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#4> <span class=md-ellipsis> 4 神经网络 </span> </a> <nav aria-label="4 神经网络" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#41> <span class=md-ellipsis> 4.1 流程 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#42> <span class=md-ellipsis> 4.2 多类别 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#43> <span class=md-ellipsis> 4.3 其它激活函数 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#5> <span class=md-ellipsis> 5 模型评估 </span> </a> <nav aria-label="5 模型评估" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#51> <span class=md-ellipsis> 5.1 概念汇总 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#52> <span class=md-ellipsis> 5.2 偏差方差和神经网络 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#53> <span class=md-ellipsis> 5.3 数据扩充 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#54> <span class=md-ellipsis> 5.4 机器学习项目的完整周期 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#55> <span class=md-ellipsis> 5.5 处理倾斜数据集与评价指标 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#6> <span class=md-ellipsis> 6 决策树 </span> </a> <nav aria-label="6 决策树" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#61> <span class=md-ellipsis> 6.1 以信息增益作为分裂标准示例 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#62> <span class=md-ellipsis> 6.2 回归树 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#63> <span class=md-ellipsis> 6.3 随机森林 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#64-xg-boost> <span class=md-ellipsis> 6.4 XG Boost </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#7> <span class=md-ellipsis> 7 选择哪种模型? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#8-k-means> <span class=md-ellipsis> 8 K-Means </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#9> <span class=md-ellipsis> 9 异常检测 </span> </a> <nav aria-label="9 异常检测" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#91> <span class=md-ellipsis> 9.1 调整 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#10> <span class=md-ellipsis> 10 协同过滤 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#11_1> <span class=md-ellipsis> 11 基于内容的过滤 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#12_1> <span class=md-ellipsis> 12 强化学习 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_3_3 type=checkbox> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_3_3_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../aitools/numpy/ class=md-nav__link> <span class=md-ellipsis> Numpy </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_4 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../tools/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16h-2v-1H8v1H6v-1H2v5h20v-5h-4zm2-8h-3V6c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v4h4v-2h2v2h8v-2h2v2h4v-4c0-1.1-.9-2-2-2m-5 0H9V6h6z"></path></svg> <span class=md-ellipsis> Else </span> </a> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Else </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_4_2 type=checkbox> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> autohotkey </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> autohotkey </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/autohotkey/auto/ class=md-nav__link> <span class=md-ellipsis> 键位映射 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_4_3 type=checkbox> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> git &amp; github </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_3_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> git &amp; github </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/git/git/ class=md-nav__link> <span class=md-ellipsis> git </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/git/github/ class=md-nav__link> <span class=md-ellipsis> github </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_4_4 type=checkbox> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> problems I met </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_4_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> problems I met </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/problem/problem/ class=md-nav__link> <span class=md-ellipsis> problem and solution </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../summary/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M6 1h2v2h8V1h2v2h1a2 2 0 0 1 2 2v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.11.89-2 2-2h1zM5 8v11h14V8zm2 2h10v2H7z"></path></svg> <span class=md-ellipsis> Summary </span> </a> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Summary </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5_2 type=checkbox> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> summaries </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_5_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> summaries </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../summary/2025/03_05/ class=md-nav__link> <span class=md-ellipsis> 第3~5周 </span> </a> </li> <li class=md-nav__item> <a href=../../../summary/2025/06/ class=md-nav__link> <span class=md-ellipsis> 第 6 周 </span> </a> </li> <li class=md-nav__item> <a href=../../../summary/2025/07/ class=md-nav__link> <span class=md-ellipsis> 第 7 周 </span> </a> </li> <li class=md-nav__item> <a href=../../../summary/2025/08/ class=md-nav__link> <span class=md-ellipsis> 第 8 周 </span> </a> </li> <li class=md-nav__item> <a href=../../../summary/2025/09/ class=md-nav__link> <span class=md-ellipsis> 第 9 周 </span> </a> </li> <li class=md-nav__item> <a href=../../../summary/2025/10/ class=md-nav__link> <span class=md-ellipsis> 第 10 周 </span> </a> </li> <li class=md-nav__item> <a href=../../../summary/2025/11/ class=md-nav__link> <span class=md-ellipsis> 第 11 周 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_6 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../Blogs/ class=md-nav__link> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"></path></svg> <span class=md-ellipsis> Blogs </span> </a> </div> <nav aria-expanded=false aria-labelledby=__nav_6_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Blogs </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tags/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg> <span class=md-ellipsis> Tags </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=目录 class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#0> <span class=md-ellipsis> 0 什么是机器学习 </span> </a> <nav aria-label="0 什么是机器学习" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#_1> <span class=md-ellipsis> 监督学习 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#_2> <span class=md-ellipsis> 无监督学习 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#1> <span class=md-ellipsis> 1 线性回归 </span> </a> <nav aria-label="1 线性回归" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#11> <span class=md-ellipsis> 1.1 成本函数 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#12> <span class=md-ellipsis> 1.2 梯度下降 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#13> <span class=md-ellipsis> 1.3 梯度下降代码实现 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#2> <span class=md-ellipsis> 2 多元线性回归 </span> </a> <nav aria-label="2 多元线性回归" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#21> <span class=md-ellipsis> 2.1 向量化 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#22> <span class=md-ellipsis> 2.2 多元梯度下降 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#23> <span class=md-ellipsis> 2.3 多元梯度下降代码实现 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#24> <span class=md-ellipsis> 2.4 特征缩放 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#25-z-score> <span class=md-ellipsis> 2.5 z-score 归一化代码实现 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#26> <span class=md-ellipsis> 2.6 特征工程和多项式回归 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#3> <span class=md-ellipsis> 3 逻辑回归 </span> </a> <nav aria-label="3 逻辑回归" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#31> <span class=md-ellipsis> 3.1 决策边界 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#32> <span class=md-ellipsis> 3.2 逻辑回归的成本函数 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#33> <span class=md-ellipsis> 3.3 将梯度下降应用到逻辑回归 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#34> <span class=md-ellipsis> 3.4 过拟合 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#35> <span class=md-ellipsis> 3.5 解决过拟合 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#4> <span class=md-ellipsis> 4 神经网络 </span> </a> <nav aria-label="4 神经网络" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#41> <span class=md-ellipsis> 4.1 流程 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#42> <span class=md-ellipsis> 4.2 多类别 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#43> <span class=md-ellipsis> 4.3 其它激活函数 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#5> <span class=md-ellipsis> 5 模型评估 </span> </a> <nav aria-label="5 模型评估" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#51> <span class=md-ellipsis> 5.1 概念汇总 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#52> <span class=md-ellipsis> 5.2 偏差方差和神经网络 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#53> <span class=md-ellipsis> 5.3 数据扩充 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#54> <span class=md-ellipsis> 5.4 机器学习项目的完整周期 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#55> <span class=md-ellipsis> 5.5 处理倾斜数据集与评价指标 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#6> <span class=md-ellipsis> 6 决策树 </span> </a> <nav aria-label="6 决策树" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#61> <span class=md-ellipsis> 6.1 以信息增益作为分裂标准示例 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#62> <span class=md-ellipsis> 6.2 回归树 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#63> <span class=md-ellipsis> 6.3 随机森林 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#64-xg-boost> <span class=md-ellipsis> 6.4 XG Boost </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#7> <span class=md-ellipsis> 7 选择哪种模型? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#8-k-means> <span class=md-ellipsis> 8 K-Means </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#9> <span class=md-ellipsis> 9 异常检测 </span> </a> <nav aria-label="9 异常检测" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#91> <span class=md-ellipsis> 9.1 调整 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#10> <span class=md-ellipsis> 10 协同过滤 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#11_1> <span class=md-ellipsis> 11 基于内容的过滤 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#12_1> <span class=md-ellipsis> 12 强化学习 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href=https://github.com/Auzers/notes/edit/main/docs/ai/ml/wedml.md title=edit.link.title> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"></path></svg> </a> <div class=md-typeset> <div class=blogging-tags-grid> <a class=blogging-tag href=https://Auzers.github.io/notes/tags#AI><code>#AI</code></a> <a class=blogging-tag href="https://Auzers.github.io/notes/tags#course notes"><code>#course notes</code></a> </div> </div> <style>
    .md-typeset .blogging-tags-grid {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 5px;
    }

    .md-typeset .blogging-tag {
        color: var(--md-typeset-color);
        background-color: var(--md-typeset-code-color);
        white-space: nowrap;
        display: block;
    }

    .md-typeset .blogging-tag code {
        border-radius: 5px;
    }
</style> <h1 id=ng-machine-learning><span>Ng-Machine learning<span class=heti-spacing> </span></span>课程笔记<a class=headerlink href=#ng-machine-learning title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> 约<span class=heti-skip><span class=heti-spacing> </span>4976<span class=heti-spacing> </span></span>个字 <span class=twemoji><svg viewbox="0 0 640 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"></path></svg></span> <span>306<span class=heti-spacing> </span></span>行代码 <span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"></path></svg></span> <span>18<span class=heti-spacing> </span></span>张图片 <span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> 预计阅读时间<span class=heti-skip><span class=heti-spacing> </span>29<span class=heti-spacing> </span></span>分钟</p> </div> <div class="admonition note"> <ul> <li>@start 2025.3.9 </li> <li>@end 2025.3.15 </li> <li>相关资源 <ul> <li><a href="https://www.bilibili.com/video/BV1MN4y1S7DE/?p=20&share_source=copy_web&vd_source=5d7da9075f18e5d133f46c25ab52f885">课程视频</a> </li> <li><a href=https://github.com/greyhatguy007/Machine-Learning-Specialization-Coursera>课程仓库</a> </li> <li><a href=https://kyonhuang.top/Andrew-Ng-Machine-Learning-notes/#/ >吴恩达《机器学习》课程笔记</a> </li> </ul> </li> <li>我采用的方式是课程仓库<span><span class=heti-spacing> </span>+ vscode jupyter notebook plugin</span> </li> <li>放个正版课链接：<a href=https://www.coursera.org/specializations/machine-learning-introduction>https://www.coursera.org/specializations/machine-learning-introduction</a></li> </ul> </div> <h2 id=0><span>0<span class=heti-spacing> </span></span>什么是机器学习<a class=headerlink href=#0 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li>机器学习<ul> <li>监督学习<span><span class=heti-spacing> </span>(supervised learning)</span></li> <li>无监督学习<span><span class=heti-spacing> </span>(unsupervised learning)</span></li> </ul> </li> </ul> <h3 id=_1>监督学习<a class=headerlink href=#_1 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li><strong>监督学习</strong><ul> <li>回归<span class=heti-skip><span class=heti-spacing> </span>(regression):<span class=heti-spacing> </span></span>通过输入预测一个连续值<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>结果有无限多个可能<span><span class=heti-spacing> </span>)</span></li> <li>分类<span class=heti-skip><span class=heti-spacing> </span>(classification):<span class=heti-spacing> </span></span>通过输入预测一个离散值<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>从有限的可能中选择<span><span class=heti-spacing> </span>)</span></li> </ul> </li> <li><strong>总结</strong>：投喂的数据集<strong>有标签</strong>，让机器从中学习映射关系</li> </ul> <h3 id=_2>无监督学习<a class=headerlink href=#_2 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>投喂的数据集<strong>没有标签</strong>，机器靠数据的特征分析模式，发现隐藏的结构，不会像监督学习产生预测值。比如投喂一些动物图片，机器根据图片特征把这些图片分成几类<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>聚类算法<span><span class=heti-spacing> </span>-clustering)</span>。</li> <li>另外的算法还有降维<span><span class=heti-spacing> </span>(PCA)</span>、异常检测等</li> </ul> <h2 id=1><span>1<span class=heti-spacing> </span></span>线性回归<a class=headerlink href=#1 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li><strong>建立直觉</strong>：线性回归通过找出输入和输出之间的最佳直线关系来进行预测。它假设输入和输出有线性关系，先随机初始化一个线性关系，通过某种方式不断调整参数来最小化误差。</li> </ul> <h3 id=11><span>1.1<span class=heti-spacing> </span></span>成本函数<a class=headerlink href=#11 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>引入这个函数的目的：用于衡量模型预测的好坏</li> </ul> <div class=arithmatex>\[ J(w, b) = \frac{1}{2m} \sum_{i=1}^{m} \left( f_{w,b}(x^{(i)}) - y^{(i)} \right)^2 \]</div> <h3 id=12><span>1.2<span class=heti-spacing> </span></span>梯度下降<a class=headerlink href=#12 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>本节讨论的实际是<strong>批量梯度下降</strong> ("Batch" gradient descent)</li> <li>计算从<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(j\)</span><span class=heti-spacing> </span></span>值高点到<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(j\)</span><span class=heti-spacing> </span></span>值低点所走的最优路径</li> </ul> <div class=arithmatex>\[ \begin{equation*} \left\{ \begin{aligned} tmp\_w &amp;= w - \alpha \frac{\partial}{\partial w} J(w, b) \\ tmp\_b &amp;= b - \alpha \frac{\partial}{\partial b} J(w, b) \\ w &amp;= tmp\_w \\ b &amp;= tmp\_b \end{aligned} \right. \end{equation*} \]</div> <div class=arithmatex>\[ \begin{align*} \text{repeat}&amp;\text{ until convergence:} \; \lbrace \newline \; w &amp;= w - \alpha \frac{\partial J(w,b)}{\partial w} \; \newline b &amp;= b - \alpha \frac{\partial J(w,b)}{\partial b} \newline \rbrace \end{align*} \]</div> <ul> <li>下面是求偏导的结果</li> </ul> <div class=arithmatex>\[ \begin{align} \frac{\partial J(w,b)}{\partial w} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{w,b}(x^{(i)}) - y^{(i)})x^{(i)}\\ \frac{\partial J(w,b)}{\partial b} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{w,b}(x^{(i)}) - y^{(i)}) \\ \end{align} \]</div> <ul> <li>越接近<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(j(w, b)\)</span><span class=heti-spacing> </span></span>的最小值，梯度下降越慢</li> </ul> <h4 id=learing-rate>学习率<span><span class=heti-spacing> </span>(learing rate)</span><a class=headerlink href=#learing-rate title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h4> <ul> <li>如果<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(\alpha\)</span><span class=heti-spacing> </span></span>过小，所需的调整次数会增加</li> <li>如果<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(\alpha\)</span><span class=heti-spacing> </span></span>过大，梯度下降可能无法收敛 </li> </ul> <h4 id=_3>可能存在的问题<a class=headerlink href=#_3 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h4> <ul> <li>局部最小不是全局最小 </li> </ul> <h4 id=_4>拟合过程<a class=headerlink href=#_4 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h4> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250309193200829.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250309193200829.png></a></p> <h3 id=13><span>1.3<span class=heti-spacing> </span></span>梯度下降代码实现<a class=headerlink href=#13 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=kn>import</span> <span class=nn>math</span><span class=o>,</span> <span class=nn>copy</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>use</span><span class=p>(</span><span class=s1>'./deeplearning.mplstyle'</span><span class=p>)</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a><span class=kn>from</span> <span class=nn>lab_utils_uni</span> <span class=kn>import</span> <span class=n>plt_house_x</span><span class=p>,</span> <span class=n>plt_contour_wgrad</span><span class=p>,</span> <span class=n>plt_divergence</span><span class=p>,</span> <span class=n>plt_gradients</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a><span class=c1># Load our data set</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>1.0</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>])</span>   <span class=c1># features</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>300.0</span><span class=p>,</span> <span class=mf>500.0</span><span class=p>])</span>   <span class=c1>#target value</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=c1>#Function to calculate the cost</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a><span class=k>def</span> <span class=nf>compute_cost</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>    <span class=n>m</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>cost</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>m</span><span class=p>):</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>        <span class=n>f_wb</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>b</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>        <span class=n>cost</span> <span class=o>=</span> <span class=n>cost</span> <span class=o>+</span> <span class=p>(</span><span class=n>f_wb</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>    <span class=n>total_cost</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>m</span><span class=p>)</span> <span class=o>*</span> <span class=n>cost</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>    <span class=k>return</span> <span class=n>total_cost</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=k>def</span> <span class=nf>compute_gradient</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span> 
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>    <span class=c1># Number of training examples</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=n>m</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>    
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=n>dj_dw</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>    <span class=n>dj_db</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>m</span><span class=p>):</span>  
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>        <span class=n>f_wb</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>b</span> 
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>        <span class=n>dj_dw_i</span> <span class=o>=</span> <span class=p>(</span><span class=n>f_wb</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> 
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>        <span class=n>dj_db_i</span> <span class=o>=</span> <span class=n>f_wb</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> 
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>        <span class=n>dj_db</span> <span class=o>+=</span> <span class=n>dj_db_i</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>        <span class=n>dj_dw</span> <span class=o>+=</span> <span class=n>dj_dw_i</span> 
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=n>dj_dw</span> <span class=o>=</span> <span class=n>dj_dw</span> <span class=o>/</span> <span class=n>m</span> 
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>    <span class=n>dj_db</span> <span class=o>=</span> <span class=n>dj_db</span> <span class=o>/</span> <span class=n>m</span> 
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>    <span class=k>return</span> <span class=n>dj_dw</span><span class=p>,</span> <span class=n>dj_db</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=k>def</span> <span class=nf>gradient_descent</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w_in</span><span class=p>,</span> <span class=n>b_in</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>num_iters</span><span class=p>,</span> <span class=n>cost_function</span><span class=p>,</span> <span class=n>gradient_function</span><span class=p>):</span> 
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>    <span class=n>w</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>w_in</span><span class=p>)</span> <span class=c1># avoid modifying global w_in</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>    <span class=c1># An array to store cost J and w's at each iteration primarily for graphing later</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=n>J_history</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>    <span class=n>p_history</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>b_in</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=n>w</span> <span class=o>=</span> <span class=n>w_in</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_iters</span><span class=p>):</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>        <span class=c1># Calculate the gradient and update the parameters using gradient_function</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>        <span class=n>dj_dw</span><span class=p>,</span> <span class=n>dj_db</span> <span class=o>=</span> <span class=n>gradient_function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span> <span class=p>,</span> <span class=n>b</span><span class=p>)</span>     
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>        <span class=c1># Update Parameters using equation (3) above</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>        <span class=n>b</span> <span class=o>=</span> <span class=n>b</span> <span class=o>-</span> <span class=n>alpha</span> <span class=o>*</span> <span class=n>dj_db</span>                            
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>        <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>-</span> <span class=n>alpha</span> <span class=o>*</span> <span class=n>dj_dw</span>                            
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>        <span class=c1># Save cost J at each iteration</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>        <span class=k>if</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>100000</span><span class=p>:</span>      <span class=c1># prevent resource exhaustion </span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>            <span class=n>J_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=n>cost_function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span> <span class=p>,</span> <span class=n>b</span><span class=p>))</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>            <span class=n>p_history</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>w</span><span class=p>,</span><span class=n>b</span><span class=p>])</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>        <span class=c1># Print cost every at intervals 10 times or as many iterations if &lt; 10</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>        <span class=k>if</span> <span class=n>i</span><span class=o>%</span> <span class=n>math</span><span class=o>.</span><span class=n>ceil</span><span class=p>(</span><span class=n>num_iters</span><span class=o>/</span><span class=mi>10</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Iteration </span><span class=si>{</span><span class=n>i</span><span class=si>:</span><span class=s2>4</span><span class=si>}</span><span class=s2>: Cost </span><span class=si>{</span><span class=n>J_history</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>0.2e</span><span class=si>}</span><span class=s2> "</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>                  <span class=sa>f</span><span class=s2>"dj_dw: </span><span class=si>{</span><span class=n>dj_dw</span><span class=si>:</span><span class=s2> 0.3e</span><span class=si>}</span><span class=s2>, dj_db: </span><span class=si>{</span><span class=n>dj_db</span><span class=si>:</span><span class=s2> 0.3e</span><span class=si>}</span><span class=s2>  "</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>                  <span class=sa>f</span><span class=s2>"w: </span><span class=si>{</span><span class=n>w</span><span class=si>:</span><span class=s2> 0.3e</span><span class=si>}</span><span class=s2>, b:</span><span class=si>{</span><span class=n>b</span><span class=si>:</span><span class=s2> 0.5e</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>    <span class=k>return</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>J_history</span><span class=p>,</span> <span class=n>p_history</span> <span class=c1>#return w and J,w history for graphing</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a><span class=c1># initialize parameters</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a><span class=n>w_init</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a><span class=n>b_init</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a><span class=c1># some gradient descent settings</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a><span class=n>iterations</span> <span class=o>=</span> <span class=mi>10000</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a><span class=n>tmp_alpha</span> <span class=o>=</span> <span class=mf>1.0e-2</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a><span class=c1># run gradient descent</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a><span class=n>w_final</span><span class=p>,</span> <span class=n>b_final</span><span class=p>,</span> <span class=n>J_hist</span><span class=p>,</span> <span class=n>p_hist</span> <span class=o>=</span> <span class=n>gradient_descent</span><span class=p>(</span><span class=n>x_train</span> <span class=p>,</span><span class=n>y_train</span><span class=p>,</span> <span class=n>w_init</span><span class=p>,</span> <span class=n>b_init</span><span class=p>,</span> <span class=n>tmp_alpha</span><span class=p>,</span> 
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>                                                    <span class=n>iterations</span><span class=p>,</span> <span class=n>compute_cost</span><span class=p>,</span> <span class=n>compute_gradient</span><span class=p>)</span>
</span></code></pre></div> <h2 id=2><span>2<span class=heti-spacing> </span></span>多元线性回归<a class=headerlink href=#2 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <h3 id=21><span>2.1<span class=heti-spacing> </span></span>向量化<a class=headerlink href=#21 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>原方法</li> </ul> <div class=arithmatex>\[ f_{\vec{w},b}(\vec{x})=\sum_{j=1}^{n}w_{j}x_{j}+b \]</div> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><a href=#__codelineno-1-1><span class=linenos data-linenos="1 "></span></a><span class=n>f</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a><a href=#__codelineno-1-2><span class=linenos data-linenos="2 "></span></a><span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a><a href=#__codelineno-1-3><span class=linenos data-linenos="3 "></span></a>    <span class=n>f</span> <span class=o>=</span> <span class=n>f</span> <span class=o>+</span> <span class=n>w</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a><a href=#__codelineno-1-4><span class=linenos data-linenos="4 "></span></a><span class=n>f</span> <span class=o>=</span> <span class=n>f</span> <span class=o>+</span> <span class=n>b</span>
</span></code></pre></div> <ul> <li>向量化</li> </ul> <div class=arithmatex>\[ f_{\vec{w},b}(\vec{x})=\vec{w}\dot{\vec{x}}+b \]</div> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><a href=#__codelineno-2-1><span class=linenos data-linenos="1 "></span></a><span class=n>f</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>,</span><span class=n>x</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span>
</span></code></pre></div> <ul> <li>原理</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310103803265.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310103803265.png></a></p> <h3 id=22><span>2.2<span class=heti-spacing> </span></span>多元梯度下降<a class=headerlink href=#22 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <div class=arithmatex>\[ \begin{align*} \text{repeat}&amp;\text{ until convergence:} \; \lbrace \newline\; &amp; w_j = w_j - \alpha \frac{\partial J(\mathbf{w},b)}{\partial w_j} \; &amp; \text{for j = 0..n-1}\newline &amp;b\ \ = b - \alpha \frac{\partial J(\mathbf{w},b)}{\partial b} \newline \rbrace \end{align*} \]</div> <div class=arithmatex>\[ \begin{align} \frac{\partial J(\mathbf{w},b)}{\partial w_j} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)})x_{j}^{(i)} \\ \frac{\partial J(\mathbf{w},b)}{\partial b} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)}) \end{align} \]</div> <h3 id=23><span>2.3<span class=heti-spacing> </span></span>多元梯度下降代码实现<a class=headerlink href=#23 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><a href=#__codelineno-3-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span> <span class=nf>compute_cost</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span> 
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a><a href=#__codelineno-3-2><span class=linenos data-linenos=" 2 "></span></a>    <span class=n>m</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><a href=#__codelineno-3-3><span class=linenos data-linenos=" 3 "></span></a>    <span class=n>cost</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4></a><a href=#__codelineno-3-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>m</span><span class=p>):</span>                                
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5></a><a href=#__codelineno-3-5><span class=linenos data-linenos=" 5 "></span></a>        <span class=n>f_wb_i</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>w</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span>           <span class=c1>#(n,)(n,) = scalar (see np.dot)</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6></a><a href=#__codelineno-3-6><span class=linenos data-linenos=" 6 "></span></a>        <span class=n>cost</span> <span class=o>=</span> <span class=n>cost</span> <span class=o>+</span> <span class=p>(</span><span class=n>f_wb_i</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>**</span><span class=mi>2</span>       <span class=c1>#scalar</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7></a><a href=#__codelineno-3-7><span class=linenos data-linenos=" 7 "></span></a>    <span class=n>cost</span> <span class=o>=</span> <span class=n>cost</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>m</span><span class=p>)</span>                      <span class=c1>#scalar    </span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8></a><a href=#__codelineno-3-8><span class=linenos data-linenos=" 8 "></span></a>    <span class=k>return</span> <span class=n>cost</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9></a><a href=#__codelineno-3-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10></a><a href=#__codelineno-3-10><span class=linenos data-linenos="10 "></span></a><span class=k>def</span> <span class=nf>compute_gradient</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span> 
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11></a><a href=#__codelineno-3-11><span class=linenos data-linenos="11 "></span></a>    <span class=n>m</span><span class=p>,</span><span class=n>n</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span>           <span class=c1>#(number of examples, number of features)</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12></a><a href=#__codelineno-3-12><span class=linenos data-linenos="12 "></span></a>    <span class=n>dj_dw</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>n</span><span class=p>,))</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13></a><a href=#__codelineno-3-13><span class=linenos data-linenos="13 "></span></a>    <span class=n>dj_db</span> <span class=o>=</span> <span class=mf>0.</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14></a><a href=#__codelineno-3-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15></a><a href=#__codelineno-3-15><span class=linenos data-linenos="15 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>m</span><span class=p>):</span>                             
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16></a><a href=#__codelineno-3-16><span class=linenos data-linenos="16 "></span></a>        <span class=n>err</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>w</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span><span class=p>)</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>   
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17></a><a href=#__codelineno-3-17><span class=linenos data-linenos="17 "></span></a>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>                         
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18></a><a href=#__codelineno-3-18><span class=linenos data-linenos="18 "></span></a>            <span class=n>dj_dw</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>dj_dw</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=n>err</span> <span class=o>*</span> <span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span>    
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19></a><a href=#__codelineno-3-19><span class=linenos data-linenos="19 "></span></a>        <span class=n>dj_db</span> <span class=o>=</span> <span class=n>dj_db</span> <span class=o>+</span> <span class=n>err</span>                        
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20></a><a href=#__codelineno-3-20><span class=linenos data-linenos="20 "></span></a>    <span class=n>dj_dw</span> <span class=o>=</span> <span class=n>dj_dw</span> <span class=o>/</span> <span class=n>m</span>                                
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21></a><a href=#__codelineno-3-21><span class=linenos data-linenos="21 "></span></a>    <span class=n>dj_db</span> <span class=o>=</span> <span class=n>dj_db</span> <span class=o>/</span> <span class=n>m</span>                                
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22></a><a href=#__codelineno-3-22><span class=linenos data-linenos="22 "></span></a>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23></a><a href=#__codelineno-3-23><span class=linenos data-linenos="23 "></span></a>    <span class=k>return</span> <span class=n>dj_db</span><span class=p>,</span> <span class=n>dj_dw</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24></a><a href=#__codelineno-3-24><span class=linenos data-linenos="24 "></span></a>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25></a><a href=#__codelineno-3-25><span class=linenos data-linenos="25 "></span></a><span class=k>def</span> <span class=nf>gradient_descent</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w_in</span><span class=p>,</span> <span class=n>b_in</span><span class=p>,</span> <span class=n>cost_function</span><span class=p>,</span> 
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26></a><a href=#__codelineno-3-26><span class=linenos data-linenos="26 "></span></a>    <span class=c1># An array to store cost J and w's at each iteration primarily for graphing later</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27></a><a href=#__codelineno-3-27><span class=linenos data-linenos="27 "></span></a>    <span class=n>J_history</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28></a><a href=#__codelineno-3-28><span class=linenos data-linenos="28 "></span></a>    <span class=n>w</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>w_in</span><span class=p>)</span>  <span class=c1>#avoid modifying global w within function</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29></a><a href=#__codelineno-3-29><span class=linenos data-linenos="29 "></span></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>b_in</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30></a><a href=#__codelineno-3-30><span class=linenos data-linenos="30 "></span></a>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31></a><a href=#__codelineno-3-31><span class=linenos data-linenos="31 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_iters</span><span class=p>):</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32></a><a href=#__codelineno-3-32><span class=linenos data-linenos="32 "></span></a>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33></a><a href=#__codelineno-3-33><span class=linenos data-linenos="33 "></span></a>        <span class=c1># Calculate the gradient and update the parameters</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34></a><a href=#__codelineno-3-34><span class=linenos data-linenos="34 "></span></a>        <span class=n>dj_db</span><span class=p>,</span><span class=n>dj_dw</span> <span class=o>=</span> <span class=n>gradient_function</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>   <span class=c1>##None</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35></a><a href=#__codelineno-3-35><span class=linenos data-linenos="35 "></span></a>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36></a><a href=#__codelineno-3-36><span class=linenos data-linenos="36 "></span></a>        <span class=c1># Update Parameters using w, b, alpha and gradient</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37></a><a href=#__codelineno-3-37><span class=linenos data-linenos="37 "></span></a>        <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>-</span> <span class=n>alpha</span> <span class=o>*</span> <span class=n>dj_dw</span>               <span class=c1>##None</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38></a><a href=#__codelineno-3-38><span class=linenos data-linenos="38 "></span></a>        <span class=n>b</span> <span class=o>=</span> <span class=n>b</span> <span class=o>-</span> <span class=n>alpha</span> <span class=o>*</span> <span class=n>dj_db</span>               <span class=c1>##None</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39></a><a href=#__codelineno-3-39><span class=linenos data-linenos="39 "></span></a>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40></a><a href=#__codelineno-3-40><span class=linenos data-linenos="40 "></span></a>        <span class=c1># Save cost J at each iteration</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41></a><a href=#__codelineno-3-41><span class=linenos data-linenos="41 "></span></a>        <span class=k>if</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>100000</span><span class=p>:</span>      <span class=c1># prevent resource exhaustion </span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42></a><a href=#__codelineno-3-42><span class=linenos data-linenos="42 "></span></a>            <span class=n>J_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=n>cost_function</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>))</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43></a><a href=#__codelineno-3-43><span class=linenos data-linenos="43 "></span></a>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44></a><a href=#__codelineno-3-44><span class=linenos data-linenos="44 "></span></a>        <span class=c1># Print cost every at intervals 10 times or as many iterations if &lt; 10</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45></a><a href=#__codelineno-3-45><span class=linenos data-linenos="45 "></span></a>        <span class=k>if</span> <span class=n>i</span><span class=o>%</span> <span class=n>math</span><span class=o>.</span><span class=n>ceil</span><span class=p>(</span><span class=n>num_iters</span> <span class=o>/</span> <span class=mi>10</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46></a><a href=#__codelineno-3-46><span class=linenos data-linenos="46 "></span></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Iteration </span><span class=si>{</span><span class=n>i</span><span class=si>:</span><span class=s2>4d</span><span class=si>}</span><span class=s2>: Cost </span><span class=si>{</span><span class=n>J_history</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>8.2f</span><span class=si>}</span><span class=s2>   "</span><span class=p>)</span>
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47></a><a href=#__codelineno-3-47><span class=linenos data-linenos="47 "></span></a>
</span><span id=__span-3-48><a id=__codelineno-3-48 name=__codelineno-3-48></a><a href=#__codelineno-3-48><span class=linenos data-linenos="48 "></span></a>    <span class=k>return</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>J_history</span> <span class=c1>#return final w,b and J history for graphing</span>
</span><span id=__span-3-49><a id=__codelineno-3-49 name=__codelineno-3-49></a><a href=#__codelineno-3-49><span class=linenos data-linenos="49 "></span></a>
</span><span id=__span-3-50><a id=__codelineno-3-50 name=__codelineno-3-50></a><a href=#__codelineno-3-50><span class=linenos data-linenos="50 "></span></a><span class=c1># initialize parameters</span>
</span><span id=__span-3-51><a id=__codelineno-3-51 name=__codelineno-3-51></a><a href=#__codelineno-3-51><span class=linenos data-linenos="51 "></span></a><span class=n>X_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>2104</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>45</span><span class=p>],</span> <span class=p>[</span><span class=mi>1416</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>40</span><span class=p>],</span> <span class=p>[</span><span class=mi>852</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>35</span><span class=p>]])</span>
</span><span id=__span-3-52><a id=__codelineno-3-52 name=__codelineno-3-52></a><a href=#__codelineno-3-52><span class=linenos data-linenos="52 "></span></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>460</span><span class=p>,</span> <span class=mi>232</span><span class=p>,</span> <span class=mi>178</span><span class=p>])</span>
</span><span id=__span-3-53><a id=__codelineno-3-53 name=__codelineno-3-53></a><a href=#__codelineno-3-53><span class=linenos data-linenos="53 "></span></a><span class=n>initial_w</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>w_init</span><span class=p>)</span>
</span><span id=__span-3-54><a id=__codelineno-3-54 name=__codelineno-3-54></a><a href=#__codelineno-3-54><span class=linenos data-linenos="54 "></span></a><span class=n>initial_b</span> <span class=o>=</span> <span class=mf>0.</span>
</span><span id=__span-3-55><a id=__codelineno-3-55 name=__codelineno-3-55></a><a href=#__codelineno-3-55><span class=linenos data-linenos="55 "></span></a><span class=c1># some gradient descent settings</span>
</span><span id=__span-3-56><a id=__codelineno-3-56 name=__codelineno-3-56></a><a href=#__codelineno-3-56><span class=linenos data-linenos="56 "></span></a><span class=n>iterations</span> <span class=o>=</span> <span class=mi>1000</span>
</span><span id=__span-3-57><a id=__codelineno-3-57 name=__codelineno-3-57></a><a href=#__codelineno-3-57><span class=linenos data-linenos="57 "></span></a><span class=n>alpha</span> <span class=o>=</span> <span class=mf>5.0e-7</span>
</span><span id=__span-3-58><a id=__codelineno-3-58 name=__codelineno-3-58></a><a href=#__codelineno-3-58><span class=linenos data-linenos="58 "></span></a><span class=c1># run gradient descent </span>
</span><span id=__span-3-59><a id=__codelineno-3-59 name=__codelineno-3-59></a><a href=#__codelineno-3-59><span class=linenos data-linenos="59 "></span></a><span class=n>w_final</span><span class=p>,</span> <span class=n>b_final</span><span class=p>,</span> <span class=n>J_hist</span> <span class=o>=</span> <span class=n>gradient_descent</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>initial_w</span><span class=p>,</span> <span class=n>initial_b</span><span class=p>,</span>
</span><span id=__span-3-60><a id=__codelineno-3-60 name=__codelineno-3-60></a><a href=#__codelineno-3-60><span class=linenos data-linenos="60 "></span></a>                                                    <span class=n>compute_cost</span><span class=p>,</span> <span class=n>compute_gradient</span><span class=p>,</span> 
</span><span id=__span-3-61><a id=__codelineno-3-61 name=__codelineno-3-61></a><a href=#__codelineno-3-61><span class=linenos data-linenos="61 "></span></a>                                                    <span class=n>alpha</span><span class=p>,</span> <span class=n>iterations</span><span class=p>)</span>
</span></code></pre></div> <h3 id=24><span>2.4<span class=heti-spacing> </span></span>特征缩放<a class=headerlink href=#24 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>目的是加速梯度下降的收敛<ul> <li>由于不同特征的数量级可能会有差异，导致对应的<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(w_{i}\)</span><span class=heti-spacing> </span></span>权重更高，后果是梯度下降走<span class=heti-skip><span class=heti-spacing> </span>Z<span class=heti-spacing> </span></span>字。</li> </ul> </li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310195806439.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310195806439.png></a></p> <ul> <li>均值归一化 </li> </ul> <div class=arithmatex>\[ x_i := \dfrac{x_i - \mu_i}{max - min} \]</div> <ul> <li><span>z-score<span class=heti-spacing> </span></span>归一化<ul> <li>归一化，所有要素平均值为<span><span class=heti-spacing> </span>0</span>，标准差为<span><span class=heti-spacing> </span>1</span></li> </ul> </li> </ul> <div class=arithmatex>\[ x^{(i)}_j = \dfrac{x^{(i)}_j - \mu_j}{\sigma_j} \]</div> <div class=arithmatex>\[ \begin{align} \mu_j &amp;= \frac{1}{m} \sum_{i=0}^{m-1} x^{(i)}_j\\ \sigma^2_j &amp;= \frac{1}{m} \sum_{i=0}^{m-1} (x^{(i)}_j - \mu_j)^2 \end{align} \]</div> <h3 id=25-z-score><span>2.5 z-score<span class=heti-spacing> </span></span>归一化代码实现<a class=headerlink href=#25-z-score title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><a href=#__codelineno-4-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span> <span class=nf>zscore_normalize_features</span><span class=p>(</span><span class=n>X</span><span class=p>):</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><a href=#__codelineno-4-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a><a href=#__codelineno-4-3><span class=linenos data-linenos=" 3 "></span></a><span class=sd>    computes  X, zcore normalized by column</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a><a href=#__codelineno-4-4><span class=linenos data-linenos=" 4 "></span></a>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><a href=#__codelineno-4-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a><a href=#__codelineno-4-6><span class=linenos data-linenos=" 6 "></span></a><span class=sd>      X (ndarray (m,n))     : input data, m examples, n features</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a><a href=#__codelineno-4-7><span class=linenos data-linenos=" 7 "></span></a>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8></a><a href=#__codelineno-4-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>    Returns:</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9></a><a href=#__codelineno-4-9><span class=linenos data-linenos=" 9 "></span></a><span class=sd>      X_norm (ndarray (m,n)): input normalized by column</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10></a><a href=#__codelineno-4-10><span class=linenos data-linenos="10 "></span></a><span class=sd>      mu (ndarray (n,))     : mean of each feature</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11></a><a href=#__codelineno-4-11><span class=linenos data-linenos="11 "></span></a><span class=sd>      sigma (ndarray (n,))  : standard deviation of each feature</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12></a><a href=#__codelineno-4-12><span class=linenos data-linenos="12 "></span></a><span class=sd>    """</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13></a><a href=#__codelineno-4-13><span class=linenos data-linenos="13 "></span></a>    <span class=c1># find the mean of each column/feature</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14></a><a href=#__codelineno-4-14><span class=linenos data-linenos="14 "></span></a>    <span class=n>mu</span>     <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>                 <span class=c1># mu will have shape (n,)</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15></a><a href=#__codelineno-4-15><span class=linenos data-linenos="15 "></span></a>    <span class=c1># find the standard deviation of each column/feature</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16></a><a href=#__codelineno-4-16><span class=linenos data-linenos="16 "></span></a>    <span class=n>sigma</span>  <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>                  <span class=c1># sigma will have shape (n,)</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17></a><a href=#__codelineno-4-17><span class=linenos data-linenos="17 "></span></a>    <span class=c1># element-wise, subtract mu for that column from each example, divide by std for that column</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18></a><a href=#__codelineno-4-18><span class=linenos data-linenos="18 "></span></a>    <span class=n>X_norm</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>-</span> <span class=n>mu</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span>      
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19></a><a href=#__codelineno-4-19><span class=linenos data-linenos="19 "></span></a>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20></a><a href=#__codelineno-4-20><span class=linenos data-linenos="20 "></span></a>    <span class=k>return</span> <span class=p>(</span><span class=n>X_norm</span><span class=p>,</span> <span class=n>mu</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span>
</span></code></pre></div> <ul> <li><span>axis=0<span class=heti-spacing> </span></span>表示逐列求均值，<span>axis=1<span class=heti-spacing> </span></span>表示逐行求均值</li> <li>下面是三种特征缩放的对比图</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310191453830.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310191453830.png></a></p> <p>进行预测</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><a href=#__codelineno-5-1><span class=linenos data-linenos=" 1 "></span></a><span class=c1>#predict target using normalized features</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a><a href=#__codelineno-5-2><span class=linenos data-linenos=" 2 "></span></a><span class=n>m</span> <span class=o>=</span> <span class=n>X_norm</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><a href=#__codelineno-5-3><span class=linenos data-linenos=" 3 "></span></a><span class=n>yp</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><a href=#__codelineno-5-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>m</span><span class=p>):</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a><a href=#__codelineno-5-5><span class=linenos data-linenos=" 5 "></span></a>    <span class=n>yp</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>X_norm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>w_norm</span><span class=p>)</span> <span class=o>+</span> <span class=n>b_norm</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a><a href=#__codelineno-5-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><a href=#__codelineno-5-7><span class=linenos data-linenos=" 7 "></span></a>    <span class=c1># plot predictions and targets versus original features    </span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a><a href=#__codelineno-5-8><span class=linenos data-linenos=" 8 "></span></a><span class=n>fig</span><span class=p>,</span><span class=n>ax</span><span class=o>=</span><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span><span class=n>sharey</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><a href=#__codelineno-5-9><span class=linenos data-linenos=" 9 "></span></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>ax</span><span class=p>)):</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><a href=#__codelineno-5-10><span class=linenos data-linenos="10 "></span></a>    <span class=n>ax</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X_train</span><span class=p>[:,</span><span class=n>i</span><span class=p>],</span><span class=n>y_train</span><span class=p>,</span> <span class=n>label</span> <span class=o>=</span> <span class=s1>'target'</span><span class=p>)</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><a href=#__codelineno-5-11><span class=linenos data-linenos="11 "></span></a>    <span class=n>ax</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=n>X_features</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12></a><a href=#__codelineno-5-12><span class=linenos data-linenos="12 "></span></a>    <span class=n>ax</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X_train</span><span class=p>[:,</span><span class=n>i</span><span class=p>],</span><span class=n>yp</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=n>dlc</span><span class=p>[</span><span class=s2>"dlorange"</span><span class=p>],</span> <span class=n>label</span> <span class=o>=</span> <span class=s1>'predict'</span><span class=p>)</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13></a><a href=#__codelineno-5-13><span class=linenos data-linenos="13 "></span></a><span class=n>ax</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>"Price"</span><span class=p>);</span> <span class=n>ax</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>();</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14></a><a href=#__codelineno-5-14><span class=linenos data-linenos="14 "></span></a><span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span><span class=p>(</span><span class=s2>"target versus prediction using z-score normalized model"</span><span class=p>)</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15></a><a href=#__codelineno-5-15><span class=linenos data-linenos="15 "></span></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310195128783.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310195128783.png></a></p> <ul> <li>用于预测的<span class=heti-skip><span class=heti-spacing> </span>input<span class=heti-spacing> </span></span>也必须标准化</li> </ul> <h4 id=_5>怎么选择合适的学习率<a class=headerlink href=#_5 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h4> <ul> <li>尝试并观察参数变化</li> </ul> <h3 id=26><span>2.6<span class=heti-spacing> </span></span>特征工程和多项式回归<a class=headerlink href=#26 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li><strong>特征工程</strong>:<strong>从原始数据中提取、转换或创建更有意义的特征，以提高机器学习模型的表现</strong>,<strong>能够提高预测准确性</strong><ul> <li>如发现<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(wx+b\)</span><span class=heti-spacing> </span></span>拟合效果不好，创建一个特征<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(x^2\)</span> ,<span class=heti-spacing> </span></span>尝试用<span><span class=heti-spacing> </span><span class=arithmatex>\(w_{0}x_{0}+w_{1}x_{1}^2\)</span></span></li> </ul> </li> <li>没有进行梯度下降之前就可以使用替代视图进行拟合效果分析</li> </ul> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><a href=#__codelineno-6-1><span class=linenos data-linenos=" 1 "></span></a><span class=c1># create target data</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2></a><a href=#__codelineno-6-2><span class=linenos data-linenos=" 2 "></span></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3></a><a href=#__codelineno-6-3><span class=linenos data-linenos=" 3 "></span></a><span class=n>y</span> <span class=o>=</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4></a><a href=#__codelineno-6-4><span class=linenos data-linenos=" 4 "></span></a>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5></a><a href=#__codelineno-6-5><span class=linenos data-linenos=" 5 "></span></a><span class=c1># engineer features .</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6></a><a href=#__codelineno-6-6><span class=linenos data-linenos=" 6 "></span></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>c_</span><span class=p>[</span><span class=n>x</span><span class=p>,</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=n>x</span><span class=o>**</span><span class=mi>3</span><span class=p>]</span>   <span class=c1>#&lt;-- added engineered feature</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7></a><a href=#__codelineno-6-7><span class=linenos data-linenos=" 7 "></span></a><span class=n>X_features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'x'</span><span class=p>,</span><span class=s1>'x^2'</span><span class=p>,</span><span class=s1>'x^3'</span><span class=p>]</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8></a><a href=#__codelineno-6-8><span class=linenos data-linenos=" 8 "></span></a>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9></a><a href=#__codelineno-6-9><span class=linenos data-linenos=" 9 "></span></a><span class=n>fig</span><span class=p>,</span><span class=n>ax</span><span class=o>=</span><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=n>sharey</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10></a><a href=#__codelineno-6-10><span class=linenos data-linenos="10 "></span></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>ax</span><span class=p>)):</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11></a><a href=#__codelineno-6-11><span class=linenos data-linenos="11 "></span></a>    <span class=n>ax</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span><span class=n>i</span><span class=p>],</span><span class=n>y</span><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12></a><a href=#__codelineno-6-12><span class=linenos data-linenos="12 "></span></a>    <span class=n>ax</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=n>X_features</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13></a><a href=#__codelineno-6-13><span class=linenos data-linenos="13 "></span></a><span class=n>ax</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>"y"</span><span class=p>)</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14></a><a href=#__codelineno-6-14><span class=linenos data-linenos="14 "></span></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310233411810.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250310233411810.png></a></p> <ul> <li>一个问题是<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(x,x^2,x^3\)</span><span class=heti-spacing> </span></span>的尺度可能会有较大差异，可以使用<span class=heti-skip><span class=heti-spacing> </span>z-score<span class=heti-spacing> </span></span>归一化来解决 </li> </ul> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1></a><a href=#__codelineno-7-1><span class=linenos data-linenos="1 "></span></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2></a><a href=#__codelineno-7-2><span class=linenos data-linenos="2 "></span></a><span class=n>y</span> <span class=o>=</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3></a><a href=#__codelineno-7-3><span class=linenos data-linenos="3 "></span></a>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4></a><a href=#__codelineno-7-4><span class=linenos data-linenos="4 "></span></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>c_</span><span class=p>[</span><span class=n>x</span><span class=p>,</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=n>x</span><span class=o>**</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5></a><a href=#__codelineno-7-5><span class=linenos data-linenos="5 "></span></a><span class=n>X</span> <span class=o>=</span> <span class=n>zscore_normalize_features</span><span class=p>(</span><span class=n>X</span><span class=p>)</span> 
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6></a><a href=#__codelineno-7-6><span class=linenos data-linenos="6 "></span></a>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7></a><a href=#__codelineno-7-7><span class=linenos data-linenos="7 "></span></a><span class=n>model_w</span><span class=p>,</span> <span class=n>model_b</span> <span class=o>=</span> <span class=n>run_gradient_descent_feng</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>iterations</span><span class=o>=</span><span class=mi>100000</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>1e-1</span><span class=p>)</span>
</span></code></pre></div> <ul> <li>可以应用特征工程对相对复杂的函数建模，泰勒已经告诉了我们这个结论</li> </ul> <h2 id=3><span>3<span class=heti-spacing> </span></span>逻辑回归<a class=headerlink href=#3 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li>一种用于<strong>二分类</strong>的算法</li> <li>原先的线性方程不能很好地拟合二分类的图像</li> <li>于是进行了巧妙的映射，如下</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250311104638125.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250311104638125.png></a></p> <h3 id=31><span>3.1<span class=heti-spacing> </span></span>决策边界<a class=headerlink href=#31 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>在逻辑回归中，我们使用 <strong><span>Sigmoid<span class=heti-spacing> </span></span>函数</strong> 计算概率：<br> 一般当 <span class=arithmatex>\(g(z) = \frac{1}{1+e^{-z}}&gt;0.5\)</span> 时，我们认为 y = 1, 而这个点恰好对应 <span class=arithmatex>\(\vec{w}\vec{x}+b=0\)</span></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250311105832609.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250311105832609.png></a></p> <h3 id=32><span>3.2<span class=heti-spacing> </span></span>逻辑回归的成本函数<a class=headerlink href=#32 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>如果还是使用线性回归的成本函数，得到的曲线有多个局部最小值。所以需要另外定义一个成本函数。</p> <ul> <li>逻辑回归的损失函数如下，只针对一个样本</li> </ul> <div class=arithmatex>\[ \begin{equation} loss(f_{\mathbf{w},b}(\mathbf{x}^{(i)}), y^{(i)}) = \begin{cases} - \log\left(f_{\mathbf{w},b}\left( \mathbf{x}^{(i)} \right) \right) &amp; \text{if $y^{(i)}=1$}\\ - \log \left( 1 - f_{\mathbf{w},b}\left( \mathbf{x}^{(i)} \right) \right) &amp; \text{if $y^{(i)}=0$} \end{cases} \end{equation} \]</div> <p>也可以简写为</p> <div class=arithmatex>\[ loss(f_{\mathbf{w},b}(\mathbf{x}^{(i)}), y^{(i)}) = (-y^{(i)} \log\left(f_{\mathbf{w},b}\left( \mathbf{x}^{(i)} \right) \right) - \left( 1 - y^{(i)}\right) \log \left( 1 - f_{\mathbf{w},b}\left( \mathbf{x}^{(i)} \right) \right) \]</div> <p>合理之处在于如果预测值接近正确类别损失较小，如果预测值接近错误类别损失较大，同时连续且可微，便于梯度下降优化</p> <ul> <li>成本函数如下</li> </ul> <div class=arithmatex>\[ J(\mathbf{w},b) = \frac{1}{m} \sum_{i=0}^{m-1} \left[ loss(f_{\mathbf{w},b}(\mathbf{x}^{(i)}), y^{(i)}) \right] \]</div> <ul> <li>代码实现</li> </ul> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1></a><a href=#__codelineno-8-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span> <span class=nf>compute_cost_logistic</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2></a><a href=#__codelineno-8-2><span class=linenos data-linenos=" 2 "></span></a>    <span class=n>m</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3></a><a href=#__codelineno-8-3><span class=linenos data-linenos=" 3 "></span></a>    <span class=n>cost</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4></a><a href=#__codelineno-8-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>m</span><span class=p>):</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5></a><a href=#__codelineno-8-5><span class=linenos data-linenos=" 5 "></span></a>        <span class=n>z_i</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=n>w</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6></a><a href=#__codelineno-8-6><span class=linenos data-linenos=" 6 "></span></a>        <span class=n>f_wb_i</span> <span class=o>=</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>z_i</span><span class=p>)</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7></a><a href=#__codelineno-8-7><span class=linenos data-linenos=" 7 "></span></a>        <span class=n>cost</span> <span class=o>+=</span>  <span class=o>-</span><span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>f_wb_i</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>f_wb_i</span><span class=p>)</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8></a><a href=#__codelineno-8-8><span class=linenos data-linenos=" 8 "></span></a>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9></a><a href=#__codelineno-8-9><span class=linenos data-linenos=" 9 "></span></a>    <span class=n>cost</span> <span class=o>=</span> <span class=n>cost</span> <span class=o>/</span> <span class=n>m</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10></a><a href=#__codelineno-8-10><span class=linenos data-linenos="10 "></span></a>    <span class=k>return</span> <span class=n>cost</span>
</span></code></pre></div> <h3 id=33><span>3.3<span class=heti-spacing> </span></span>将梯度下降应用到逻辑回归<a class=headerlink href=#33 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>逻辑回归的梯度下降仍然满足下式</p> <div class=arithmatex>\[ \begin{align} \frac{\partial J(\mathbf{w},b)}{\partial w_j} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)})x_{j}^{(i)} \\ \frac{\partial J(\mathbf{w},b)}{\partial b} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)}) \end{align} \]</div> <ul> <li><strong>代码实现</strong></li> </ul> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1></a><a href=#__codelineno-9-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span> <span class=nf>compute_gradient_logistic</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span> 
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2></a><a href=#__codelineno-9-2><span class=linenos data-linenos=" 2 "></span></a>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3></a><a href=#__codelineno-9-3><span class=linenos data-linenos=" 3 "></span></a>    <span class=n>m</span><span class=p>,</span><span class=n>n</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4></a><a href=#__codelineno-9-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=n>dj_dw</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>n</span><span class=p>,))</span>                           <span class=c1>#(n,)</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5></a><a href=#__codelineno-9-5><span class=linenos data-linenos=" 5 "></span></a>    <span class=n>dj_db</span> <span class=o>=</span> <span class=mf>0.</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6></a><a href=#__codelineno-9-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7></a><a href=#__codelineno-9-7><span class=linenos data-linenos=" 7 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>m</span><span class=p>):</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8></a><a href=#__codelineno-9-8><span class=linenos data-linenos=" 8 "></span></a>        <span class=n>f_wb_i</span> <span class=o>=</span> <span class=n>sigmoid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=n>w</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span><span class=p>)</span>          <span class=c1>#(n,)(n,)=scalar</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9></a><a href=#__codelineno-9-9><span class=linenos data-linenos=" 9 "></span></a>        <span class=n>err_i</span>  <span class=o>=</span> <span class=n>f_wb_i</span>  <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>                       <span class=c1>#scalar</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10></a><a href=#__codelineno-9-10><span class=linenos data-linenos="10 "></span></a>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11></a><a href=#__codelineno-9-11><span class=linenos data-linenos="11 "></span></a>            <span class=n>dj_dw</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>dj_dw</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=n>err_i</span> <span class=o>*</span> <span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span>      <span class=c1>#scalar</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12></a><a href=#__codelineno-9-12><span class=linenos data-linenos="12 "></span></a>        <span class=n>dj_db</span> <span class=o>=</span> <span class=n>dj_db</span> <span class=o>+</span> <span class=n>err_i</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13></a><a href=#__codelineno-9-13><span class=linenos data-linenos="13 "></span></a>    <span class=n>dj_dw</span> <span class=o>=</span> <span class=n>dj_dw</span><span class=o>/</span><span class=n>m</span>                                   <span class=c1>#(n,)</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14></a><a href=#__codelineno-9-14><span class=linenos data-linenos="14 "></span></a>    <span class=n>dj_db</span> <span class=o>=</span> <span class=n>dj_db</span><span class=o>/</span><span class=n>m</span>                                   <span class=c1>#scalar</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15></a><a href=#__codelineno-9-15><span class=linenos data-linenos="15 "></span></a>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16></a><a href=#__codelineno-9-16><span class=linenos data-linenos="16 "></span></a>    <span class=k>return</span> <span class=n>dj_db</span><span class=p>,</span> <span class=n>dj_dw</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17></a><a href=#__codelineno-9-17><span class=linenos data-linenos="17 "></span></a>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18></a><a href=#__codelineno-9-18><span class=linenos data-linenos="18 "></span></a><span class=k>def</span> <span class=nf>gradient_descent</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w_in</span><span class=p>,</span> <span class=n>b_in</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>num_iters</span><span class=p>):</span> 
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19></a><a href=#__codelineno-9-19><span class=linenos data-linenos="19 "></span></a>    <span class=c1># An array to store cost J and w's at each iteration primarily for graphing later</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20></a><a href=#__codelineno-9-20><span class=linenos data-linenos="20 "></span></a>    <span class=n>J_history</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21></a><a href=#__codelineno-9-21><span class=linenos data-linenos="21 "></span></a>    <span class=n>w</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>w_in</span><span class=p>)</span>  <span class=c1>#avoid modifying global w within function</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22></a><a href=#__codelineno-9-22><span class=linenos data-linenos="22 "></span></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>b_in</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23></a><a href=#__codelineno-9-23><span class=linenos data-linenos="23 "></span></a>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24></a><a href=#__codelineno-9-24><span class=linenos data-linenos="24 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_iters</span><span class=p>):</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25></a><a href=#__codelineno-9-25><span class=linenos data-linenos="25 "></span></a>        <span class=c1># Calculate the gradient and update the parameters</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26></a><a href=#__codelineno-9-26><span class=linenos data-linenos="26 "></span></a>        <span class=n>dj_db</span><span class=p>,</span> <span class=n>dj_dw</span> <span class=o>=</span> <span class=n>compute_gradient_logistic</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>   
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27></a><a href=#__codelineno-9-27><span class=linenos data-linenos="27 "></span></a>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28></a><a href=#__codelineno-9-28><span class=linenos data-linenos="28 "></span></a>        <span class=c1># Update Parameters using w, b, alpha and gradient</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29></a><a href=#__codelineno-9-29><span class=linenos data-linenos="29 "></span></a>        <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>-</span> <span class=n>alpha</span> <span class=o>*</span> <span class=n>dj_dw</span>               
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30></a><a href=#__codelineno-9-30><span class=linenos data-linenos="30 "></span></a>        <span class=n>b</span> <span class=o>=</span> <span class=n>b</span> <span class=o>-</span> <span class=n>alpha</span> <span class=o>*</span> <span class=n>dj_db</span>               
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31></a><a href=#__codelineno-9-31><span class=linenos data-linenos="31 "></span></a>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32></a><a href=#__codelineno-9-32><span class=linenos data-linenos="32 "></span></a>        <span class=c1># Save cost J at each iteration</span>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33></a><a href=#__codelineno-9-33><span class=linenos data-linenos="33 "></span></a>        <span class=k>if</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>100000</span><span class=p>:</span>      <span class=c1># prevent resource exhaustion </span>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34></a><a href=#__codelineno-9-34><span class=linenos data-linenos="34 "></span></a>            <span class=n>J_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=n>compute_cost_logistic</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=p>)</span>
</span><span id=__span-9-35><a id=__codelineno-9-35 name=__codelineno-9-35></a><a href=#__codelineno-9-35><span class=linenos data-linenos="35 "></span></a>
</span><span id=__span-9-36><a id=__codelineno-9-36 name=__codelineno-9-36></a><a href=#__codelineno-9-36><span class=linenos data-linenos="36 "></span></a>        <span class=c1># Print cost every at intervals 10 times or as many iterations if &lt; 10</span>
</span><span id=__span-9-37><a id=__codelineno-9-37 name=__codelineno-9-37></a><a href=#__codelineno-9-37><span class=linenos data-linenos="37 "></span></a>        <span class=k>if</span> <span class=n>i</span><span class=o>%</span> <span class=n>math</span><span class=o>.</span><span class=n>ceil</span><span class=p>(</span><span class=n>num_iters</span> <span class=o>/</span> <span class=mi>10</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-9-38><a id=__codelineno-9-38 name=__codelineno-9-38></a><a href=#__codelineno-9-38><span class=linenos data-linenos="38 "></span></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Iteration </span><span class=si>{</span><span class=n>i</span><span class=si>:</span><span class=s2>4d</span><span class=si>}</span><span class=s2>: Cost </span><span class=si>{</span><span class=n>J_history</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>   "</span><span class=p>)</span>
</span><span id=__span-9-39><a id=__codelineno-9-39 name=__codelineno-9-39></a><a href=#__codelineno-9-39><span class=linenos data-linenos="39 "></span></a>
</span><span id=__span-9-40><a id=__codelineno-9-40 name=__codelineno-9-40></a><a href=#__codelineno-9-40><span class=linenos data-linenos="40 "></span></a>    <span class=k>return</span> <span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>J_history</span>         <span class=c1>#return final w,b and J history for graphing</span>
</span></code></pre></div> <h3 id=34><span>3.4<span class=heti-spacing> </span></span>过拟合<a class=headerlink href=#34 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>对给出的样本拟合效果很好但是预测效果不佳</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250311201139546.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250311201139546.png></a></p> <h3 id=35><span>3.5<span class=heti-spacing> </span></span>解决过拟合<a class=headerlink href=#35 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>更多的训练数据</li> <li>减少特征数量</li> <li>正则化</li> </ul> <h4 id=_6>正则化<a class=headerlink href=#_6 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h4> <ul> <li>对于高阶的特征项，我们通常希望它们的系数较小，以减少模型复杂度，防止过拟合</li> </ul> <p>对此我们需要更改成本函数表达式</p> <p>对于线性回归</p> <div class=arithmatex>\[ J(\mathbf{w},b) = \frac{1}{2m} \sum\limits_{i = 0}^{m-1} (f_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)})^2 + \frac{\lambda}{2m} \sum_{j=0}^{n-1} w_j^2 \]</div> <p>对于逻辑回归</p> <div class=arithmatex>\[ J(\mathbf{w},b) = \frac{1}{m} \sum_{i=0}^{m-1} \left[ -y^{(i)} \log\left(f_{\mathbf{w},b}\left( \mathbf{x}^{(i)} \right) \right) - \left( 1 - y^{(i)}\right) \log \left( 1 - f_{\mathbf{w},b}\left( \mathbf{x}^{(i)} \right) \right) \right] + \frac{\lambda}{2m} \sum_{j=0}^{n-1} w_j^2 \]</div> <p>梯度下降实现相同</p> <div class=arithmatex>\[ \begin{align*} \frac{\partial J(\mathbf{w},b)}{\partial w_j} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)})x_{j}^{(i)} + \frac{\lambda}{m} w_j\\ \frac{\partial J(\mathbf{w},b)}{\partial b} &amp;= \frac{1}{m} \sum\limits_{i = 0}^{m-1} (f_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)}) \end{align*} \]</div> <p>不展示实现了，多了几项而已</p> <h2 id=4><span>4<span class=heti-spacing> </span></span>神经网络<a class=headerlink href=#4 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250315112713473.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250315112713473.png></a></p> <ul> <li>建立直觉：大概意思就是，每一个神经元的输出作为下一个神经元的输入，最后一个神经元的输出就是预测结果<span class=heti-skip><span class=heti-spacing> </span>.<span class=heti-spacing> </span></span>每一个神经元都有自己的<span class=heti-skip><span class=heti-spacing> </span>w<span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span>b,<span class=heti-spacing> </span></span>开始时随机初始化每一组<span class=heti-skip><span class=heti-spacing> </span>w<span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span>b<span class=heti-spacing> </span></span>的值，通过迭代训练调整<span class=heti-skip><span class=heti-spacing> </span>w<span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span>b<span class=heti-spacing> </span></span>使成本最小。如果神经网络很复杂，那么<span class=heti-skip><span class=heti-spacing> </span>w<span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span>b<span class=heti-spacing> </span></span>的变化往往是人类不能理解的。</li> </ul> <h3 id=41><span>4.1<span class=heti-spacing> </span></span>流程<a class=headerlink href=#41 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>前向传播</li> <li>计算损失</li> <li>反向传播更新参数</li> <li>迭代训练</li> </ul> <h3 id=42><span>4.2<span class=heti-spacing> </span></span>多类别<a class=headerlink href=#42 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>放一个代码实现：</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1></a><a href=#__codelineno-10-1><span class=linenos data-linenos=" 1 "></span></a><span class=c1># explanation</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2></a><a href=#__codelineno-10-2><span class=linenos data-linenos=" 2 "></span></a><span class=n>classes</span> <span class=o>=</span> <span class=mi>4</span> <span class=c1># number of classes</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3></a><a href=#__codelineno-10-3><span class=linenos data-linenos=" 3 "></span></a><span class=n>m</span> <span class=o>=</span> <span class=mi>100</span> <span class=c1># number of samples</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4></a><a href=#__codelineno-10-4><span class=linenos data-linenos=" 4 "></span></a><span class=n>centers</span> <span class=o>=</span> <span class=p>[[</span><span class=o>-</span><span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>]]</span> <span class=c1># centers of the clusters</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5></a><a href=#__codelineno-10-5><span class=linenos data-linenos=" 5 "></span></a><span class=n>std</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=c1># standard deviation of the clusters</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6></a><a href=#__codelineno-10-6><span class=linenos data-linenos=" 6 "></span></a><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span> <span class=o>=</span> <span class=n>make_blobs</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=n>m</span><span class=p>,</span> <span class=n>centers</span><span class=o>=</span><span class=n>centers</span><span class=p>,</span> <span class=n>cluster_std</span><span class=o>=</span><span class=n>std</span><span class=p>,</span><span class=n>random_state</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span> <span class=c1># generate training data</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7></a><a href=#__codelineno-10-7><span class=linenos data-linenos=" 7 "></span></a>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8></a><a href=#__codelineno-10-8><span class=linenos data-linenos=" 8 "></span></a><span class=n>tf</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>set_seed</span><span class=p>(</span><span class=mi>1234</span><span class=p>)</span>  <span class=c1># Set the seed for reproducibility </span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9></a><a href=#__codelineno-10-9><span class=linenos data-linenos=" 9 "></span></a><span class=n>model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>(</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10></a><a href=#__codelineno-10-10><span class=linenos data-linenos="10 "></span></a>    <span class=p>[</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11></a><a href=#__codelineno-10-11><span class=linenos data-linenos="11 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'relu'</span><span class=p>,</span>   <span class=n>name</span> <span class=o>=</span> <span class=s2>"L1"</span><span class=p>),</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12></a><a href=#__codelineno-10-12><span class=linenos data-linenos="12 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'linear'</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s2>"L2"</span><span class=p>)</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13></a><a href=#__codelineno-10-13><span class=linenos data-linenos="13 "></span></a>    <span class=p>]</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14></a><a href=#__codelineno-10-14><span class=linenos data-linenos="14 "></span></a><span class=p>)</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15></a><a href=#__codelineno-10-15><span class=linenos data-linenos="15 "></span></a><span class=c1># Compile the model</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16></a><a href=#__codelineno-10-16><span class=linenos data-linenos="16 "></span></a><span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17></a><a href=#__codelineno-10-17><span class=linenos data-linenos="17 "></span></a>    <span class=n>loss</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>losses</span><span class=o>.</span><span class=n>SparseCategoricalCrossentropy</span><span class=p>(</span><span class=n>from_logits</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span> <span class=c1># SparseCategoricalCrossentropy is used because the labels are integers</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18></a><a href=#__codelineno-10-18><span class=linenos data-linenos="18 "></span></a>    <span class=n>optimizer</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>Adam</span><span class=p>(</span><span class=mf>0.01</span><span class=p>),</span> <span class=c1># use Adom optimizer with learning rate of 0.01</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19></a><a href=#__codelineno-10-19><span class=linenos data-linenos="19 "></span></a><span class=p>)</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20></a><a href=#__codelineno-10-20><span class=linenos data-linenos="20 "></span></a>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21></a><a href=#__codelineno-10-21><span class=linenos data-linenos="21 "></span></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22></a><a href=#__codelineno-10-22><span class=linenos data-linenos="22 "></span></a>    <span class=n>X_train</span><span class=p>,</span><span class=n>y_train</span><span class=p>,</span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23></a><a href=#__codelineno-10-23><span class=linenos data-linenos="23 "></span></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>200</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24></a><a href=#__codelineno-10-24><span class=linenos data-linenos="24 "></span></a><span class=p>)</span>
</span></code></pre></div> <h3 id=43><span>4.3<span class=heti-spacing> </span></span>其它激活函数<a class=headerlink href=#43 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313102312447.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313102312447.png></a></p> <h4 id=relu>ReLU<a class=headerlink href=#relu title="Permanent link">¶</a></h4> <div class=arithmatex>\[ a=max(0,z) \]</div> <h4 id=relu_1><span>ReLU<span class=heti-spacing> </span></span>的合理性<a class=headerlink href=#relu_1 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h4> <ul> <li>避免不必要的输出，提高训练效率</li> <li>解决梯度消失的问题</li> </ul> <h4 id=softmax>softmax<a class=headerlink href=#softmax title="Permanent link">¶</a></h4> <div class=arithmatex>\[ a_j = \frac{e^{z_j}}{ \sum_{k=1}^{N}{e^{z_k} }} \]</div> <div class=arithmatex>\[ \begin{align} \mathbf{a}(x) = \begin{bmatrix} P(y = 1 | \mathbf{x}; \mathbf{w},b) \\ \vdots \\ P(y = N | \mathbf{x}; \mathbf{w},b) \end{bmatrix} = \frac{1}{ \sum_{k=1}^{N}{e^{z_k} }} \begin{bmatrix} e^{z_1} \\ \vdots \\ e^{z_{N}} \\ \end{bmatrix} \end{align} \]</div> <ul> <li><span>softmax<span class=heti-spacing> </span></span>的损失函数</li> </ul> <div class=arithmatex>\[ \begin{equation} L(\mathbf{a},y)=\begin{cases} -log(a_1), &amp; \text{if $y=1$}.\\ &amp;\vdots\\ -log(a_N), &amp; \text{if $y=N$} \end{cases} \end{equation} \]</div> <ul> <li><span>softmax<span class=heti-spacing> </span></span>的成本函数</li> </ul> <div class=arithmatex>\[ \begin{align} J(\mathbf{w},b) = -\frac{1}{m} \left[ \sum_{i=1}^{m} \sum_{j=1}^{N} 1\left\{y^{(i)} == j\right\} \log \frac{e^{z^{(i)}_j}}{\sum_{k=1}^N e^{z^{(i)}_k} }\right] \end{align} \]</div> <ul> <li><span>Tensorflow<span class=heti-spacing> </span></span>实现稀疏分类交叉熵损失的两种方法：</li> </ul> <p><strong>way 1</strong></p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1></a><a href=#__codelineno-11-1><span class=linenos data-linenos=" 1 "></span></a><span class=n>model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>(</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2></a><a href=#__codelineno-11-2><span class=linenos data-linenos=" 2 "></span></a>    <span class=p>[</span> 
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3></a><a href=#__codelineno-11-3><span class=linenos data-linenos=" 3 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>25</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'relu'</span><span class=p>),</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4></a><a href=#__codelineno-11-4><span class=linenos data-linenos=" 4 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>15</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'relu'</span><span class=p>),</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5></a><a href=#__codelineno-11-5><span class=linenos data-linenos=" 5 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'softmax'</span><span class=p>)</span>    <span class=c1># &lt; softmax activation here</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6></a><a href=#__codelineno-11-6><span class=linenos data-linenos=" 6 "></span></a>    <span class=p>]</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7></a><a href=#__codelineno-11-7><span class=linenos data-linenos=" 7 "></span></a><span class=p>)</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8></a><a href=#__codelineno-11-8><span class=linenos data-linenos=" 8 "></span></a><span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9></a><a href=#__codelineno-11-9><span class=linenos data-linenos=" 9 "></span></a>    <span class=n>loss</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>losses</span><span class=o>.</span><span class=n>SparseCategoricalCrossentropy</span><span class=p>(),</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10></a><a href=#__codelineno-11-10><span class=linenos data-linenos="10 "></span></a>    <span class=n>optimizer</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>Adam</span><span class=p>(</span><span class=mf>0.001</span><span class=p>),</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11></a><a href=#__codelineno-11-11><span class=linenos data-linenos="11 "></span></a><span class=p>)</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12></a><a href=#__codelineno-11-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13></a><a href=#__codelineno-11-13><span class=linenos data-linenos="13 "></span></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14></a><a href=#__codelineno-11-14><span class=linenos data-linenos="14 "></span></a>    <span class=n>X_train</span><span class=p>,</span><span class=n>y_train</span><span class=p>,</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15></a><a href=#__codelineno-11-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>10</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16></a><a href=#__codelineno-11-16><span class=linenos data-linenos="16 "></span></a><span class=p>)</span>
</span></code></pre></div> <p><strong>way 2</strong></p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1></a><a href=#__codelineno-12-1><span class=linenos data-linenos=" 1 "></span></a><span class=n>preferred_model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>(</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2></a><a href=#__codelineno-12-2><span class=linenos data-linenos=" 2 "></span></a>    <span class=p>[</span> 
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3></a><a href=#__codelineno-12-3><span class=linenos data-linenos=" 3 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>25</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'relu'</span><span class=p>),</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4></a><a href=#__codelineno-12-4><span class=linenos data-linenos=" 4 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>15</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'relu'</span><span class=p>),</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5></a><a href=#__codelineno-12-5><span class=linenos data-linenos=" 5 "></span></a>        <span class=n>Dense</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>activation</span> <span class=o>=</span> <span class=s1>'linear'</span><span class=p>)</span>   <span class=c1>#&lt;-- Note</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6></a><a href=#__codelineno-12-6><span class=linenos data-linenos=" 6 "></span></a>    <span class=p>]</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7></a><a href=#__codelineno-12-7><span class=linenos data-linenos=" 7 "></span></a><span class=p>)</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8></a><a href=#__codelineno-12-8><span class=linenos data-linenos=" 8 "></span></a><span class=n>preferred_model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9></a><a href=#__codelineno-12-9><span class=linenos data-linenos=" 9 "></span></a>    <span class=n>loss</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>losses</span><span class=o>.</span><span class=n>SparseCategoricalCrossentropy</span><span class=p>(</span><span class=n>from_logits</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>  <span class=c1>#&lt;-- Note</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10></a><a href=#__codelineno-12-10><span class=linenos data-linenos="10 "></span></a>    <span class=n>optimizer</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>Adam</span><span class=p>(</span><span class=mf>0.001</span><span class=p>),</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11></a><a href=#__codelineno-12-11><span class=linenos data-linenos="11 "></span></a><span class=p>)</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12></a><a href=#__codelineno-12-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13></a><a href=#__codelineno-12-13><span class=linenos data-linenos="13 "></span></a><span class=n>preferred_model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14></a><a href=#__codelineno-12-14><span class=linenos data-linenos="14 "></span></a>    <span class=n>X_train</span><span class=p>,</span><span class=n>y_train</span><span class=p>,</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15></a><a href=#__codelineno-12-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>10</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16></a><a href=#__codelineno-12-16><span class=linenos data-linenos="16 "></span></a><span class=p>)</span>
</span></code></pre></div> <ul> <li>第二种方法优于第一种方法<ul> <li>第二种方法将<span class=heti-skip><span class=heti-spacing> </span>softmax<span class=heti-spacing> </span></span>操作包含在损失计算中，这个情况下，计算机会采取更好的方法进行计算从而得到更准确的结果</li> <li>课程中的例子：<span>python<span class=heti-spacing> </span></span>中计算<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(1+\frac{1}{1000000}-(1-\frac{1}{1000000})\)</span><span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(\frac{1}{1000000}+\frac{1}{1000000}\)</span><span class=heti-spacing> </span></span>时得到的结果是不一样的</li> </ul> </li> </ul> <h4 id=_7>稀疏分类交叉熵和分类交叉熵<a class=headerlink href=#_7 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h4> <ul> <li>SparseCategorialCrossentropy：期望目标是与索引对应的整数。例如，如果有<span class=heti-skip><span class=heti-spacing> </span>10<span class=heti-spacing> </span></span>个可能的目标值，则<span class=heti-skip><span class=heti-spacing> </span>y<span class=heti-spacing> </span></span>将介于<span class=heti-skip><span class=heti-spacing> </span>0<span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span>9<span class=heti-spacing> </span></span>之间。</li> <li>CategoricalCrossEntropy：预期示例的目标值为<span class=heti-skip><span class=heti-spacing> </span>one-hot<span class=heti-spacing> </span></span>编码，其中目标索引的值为<span><span class=heti-spacing> </span>1</span>，而其他<span class=heti-skip><span class=heti-spacing> </span>N-1<span class=heti-spacing> </span></span>个条目为零。具有<span class=heti-skip><span class=heti-spacing> </span>10<span class=heti-spacing> </span></span>个潜在目标值的示例，其中目标为<span><span class=heti-spacing> </span>2</span>，则为<span><span class=heti-spacing> </span>[0,0,1,0,0,0,0,0,0,0]</span>。</li> </ul> <h2 id=5><span>5<span class=heti-spacing> </span></span>模型评估<a class=headerlink href=#5 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <h3 id=51><span>5.1<span class=heti-spacing> </span></span>概念汇总<a class=headerlink href=#51 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>数据集<ul> <li>训练集<span><span class=heti-spacing> </span>(training set)</span>：用于模型训练</li> <li>交叉验证集<span><span class=heti-spacing> </span>(dev set)</span>：训练过程中用于模型选择和超参数调优，帮助确定最佳的模型配置</li> <li>测试集<span><span class=heti-spacing> </span>(test set)</span>：用于评估模型在新数据上的表现，反应模型的泛化能力，测试集的数据在训练过程中不可见<ul> <li>如果采用测试集进行模型选择会导致实际误差大于泛化误差，因为测试集实际上介入了模型选择的过程。</li> </ul> </li> </ul> </li> <li>误差<ul> <li>实际误差：模型拟合数据的<span class=heti-skip><span class=heti-spacing> </span>"<span class=heti-spacing> </span></span>现状<span class=heti-skip><span class=heti-spacing> </span>"<span class=heti-spacing> </span></span>反映</li> <li>泛化误差：模型在所有可能的新样本上的预期误差</li> <li>基准性能水平：为衡量模型水平设定的参考标准，比如人类预测的准确率</li> </ul> </li> <li>正则化<ul> <li>目的：通过增加正则化项来防止模型过拟合</li> </ul> </li> <li>偏差与方差：<ul> <li>高偏差：模型过于简单，不能捕捉数据规律</li> <li>高方差：模型过于复杂，对训练数据过度拟合，在新数据上表现过差</li> </ul> </li> </ul> <p>一般来说，验证集的成本函数和训练集的成本函数有如下关系</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250314104558408.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250314104558408.png></a></p> <h3 id=52><span>5.2<span class=heti-spacing> </span></span>偏差方差和神经网络<a class=headerlink href=#52 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313153000531.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313153000531.png></a> </p> <p>解决偏差和方差问题的策略如下</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313152150252.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313152150252.png></a></p> <p>理论上，采用更加庞大的神经网络时，只要恰当地正则化，那么至少拥有和小型神经网络相仿的拟合结果</p> <h3 id=53><span>5.3<span class=heti-spacing> </span></span>数据扩充<a class=headerlink href=#53 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>错误分析：</li> <li>数据扩充：当数据量有限时采用数据扩充来获取新数据<ul> <li>数据增强：改造现有数据，生成新的样本，如图像识别中对已有图像进行旋转，裁剪，扭曲得到新图像</li> <li>数据合成：利用算法合成新的数据</li> </ul> </li> <li>迁移学习：当没有足够数据时，利用相似的已经经过预训练的模型得到相对合理的<span class=heti-skip><span class=heti-spacing> </span>w<span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span>b<span class=heti-spacing> </span></span>作为初始值而不是采用随机值<ul> <li>只训练最后一层：当数据量不足时</li> <li>全部训练：在预训练的基础上，对所有层进行调整</li> </ul> </li> </ul> <h3 id=54><span>5.4<span class=heti-spacing> </span></span>机器学习项目的完整周期<a class=headerlink href=#54 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>决定项目内容和你要解决的问题<span class=heti-skip><span class=heti-spacing> </span>-&gt;<span class=heti-spacing> </span></span>收集数据<span class=heti-skip><span class=heti-spacing> </span>-&gt;<span class=heti-spacing> </span></span>训练模型<span class=heti-skip><span class=heti-spacing> </span>-&gt;<span class=heti-spacing> </span></span>模型评估考虑优化训练方式<span class=heti-skip><span class=heti-spacing> </span>-&gt;<span class=heti-spacing> </span></span>部署，监视，维护模型</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313222632788.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250313222632788.png></a></p> <h3 id=55><span>5.5<span class=heti-spacing> </span></span>处理倾斜数据集与评价指标<a class=headerlink href=#55 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>倾斜数据集：数据集类别分布极不平衡，比如预测罕见病</li> <li>评价指标<ul> <li>精确率<span><span class=heti-spacing> </span>: true pos / pre pos</span> </li> <li>召回率<span class=heti-skip><span class=heti-spacing> </span>: true pos /act pos (<span class=heti-spacing> </span></span>能在患病群体中甄别出多少人<span><span class=heti-spacing> </span>)</span></li> <li><span>F1-score:<span class=heti-spacing> </span></span>精确率和召回率的调和平均<span><span class=heti-spacing> </span><span class=arithmatex>\(\frac{PR}{P+R}\)</span></span></li> </ul> </li> </ul> <p>下面是对阴阳性的定义<br> <a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250314105402987.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250314105402987.png></a></p> <h2 id=6><span>6<span class=heti-spacing> </span></span>决策树<a class=headerlink href=#6 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li>建立直觉：拿到一份数据集后，决策树通过一系列的 <strong>条件判断</strong>（例如：某特征是否大于某个值）将数据划分为不同的子集，直到每个子集的样本满足某个条件<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>此时你认为它分决策得不错<span><span class=heti-spacing> </span>)</span>。最终的结果是一个树形结构，其中每个叶子节点表示预测结果。决策树通过递归的方式构建。</li> <li>构建一棵决策树的流程<ul> <li>数据准备</li> <li>选择分裂标准</li> <li>超参数调优</li> </ul> </li> <li>独热编码的分类特征：将每一个分类的值转换为二进制向量。</li> </ul> <h3 id=61><span>6.1<span class=heti-spacing> </span></span>以信息增益作为分裂标准示例<a class=headerlink href=#61 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>信息增益<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>熵减程度<span><span class=heti-spacing> </span>):</span></p> <div class=arithmatex>\[ \text{Information Gain} = H(p_1^\text{node})- \left(w^{\text{left}}H\left(p_1^\text{left}\right) + w^{\text{right}}H\left(p_1^\text{right}\right)\right) \]</div> <div class=arithmatex>\[ H(p_1) = -p_1 \text{log}_2(p_1) - (1- p_1) \text{log}_2(1- p_1) \]</div> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250314214735305.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250314214735305.png></a></p> <h3 id=62><span>6.2<span class=heti-spacing> </span></span>回归树<a class=headerlink href=#62 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>和决策树对比<ul> <li>回归树预测连续数值</li> <li>决策树预测离散的标签</li> <li>回归树使用均方误差作为分裂标准</li> <li>决策树通常使用信息增益或基尼系数作为分裂标准</li> </ul> </li> </ul> <h3 id=63><span>6.3<span class=heti-spacing> </span></span>随机森林<a class=headerlink href=#63 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <ul> <li>单棵决策树鲁棒性差的原因<ul> <li>对数据集的细微变化很敏感<span class=heti-skip><span class=heti-spacing> </span>,<span class=heti-spacing> </span></span>有时如果只是新增加了一个数据<span class=heti-skip><span class=heti-spacing> </span>,<span class=heti-spacing> </span></span>可能会导致整棵树的结构被重构<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>如果恰好改变了根节点的特征<span><span class=heti-spacing> </span>)</span></li> </ul> </li> <li>随机森林机制：随机选取数据集的子集构建树集成，多棵树投票决定最终结果</li> <li>随机森林机制的合理性<span><span class=heti-spacing> </span>:</span><ul> <li>树之间相对独立<span class=heti-skip><span class=heti-spacing> </span>,<span class=heti-spacing> </span></span>而<span class=heti-skip><span class=heti-spacing> </span>VB<span class=heti-spacing> </span></span>可能会导致所有树共享相似的数据字集<span class=heti-skip><span class=heti-spacing> </span>,<span class=heti-spacing> </span></span>从而在相似的特征做决策<span class=heti-skip><span class=heti-spacing> </span>,<span class=heti-spacing> </span></span>导致泛化能力下降</li> </ul> </li> </ul> <h3 id=64-xg-boost>6.4 XG Boost<a class=headerlink href=#64-xg-boost title="Permanent link">¶</a></h3> <p>构建了一棵决策树后<span class=heti-skip><span class=heti-spacing> </span>,<span class=heti-spacing> </span></span>第二棵决策树的数据集不再随机<span class=heti-skip><span class=heti-spacing> </span>,<span class=heti-spacing> </span></span>而是更倾向于选择第一棵决策树分类错误的数据<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>刻意练习<span><span class=heti-spacing> </span>)</span></p> <h2 id=7><span>7<span class=heti-spacing> </span></span>选择哪种模型<span><span class=heti-spacing> </span>?</span><a class=headerlink href=#7 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li>决策树<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>树集成<span><span class=heti-spacing> </span>)</span><ul> <li>适用于结构化数据</li> <li>规模小的决策树容易被人类理解</li> </ul> </li> <li>神经网络<ul> <li>适用于任意类型的数据</li> <li>训练周期长</li> <li>适用于迁移学习</li> <li>容易组合使用</li> </ul> </li> </ul> <h2 id=8-k-means>8 K-Means<a class=headerlink href=#8-k-means title="Permanent link">¶</a></h2> <ul> <li>建立直觉：<span>K-Means<span class=heti-spacing> </span></span>是一种用<strong>聚类</strong>的算法，将数据集划分为<span class=heti-skip><span class=heti-spacing> </span>K<span class=heti-spacing> </span></span>个簇，使同簇数据点更相似，不同簇的数据点差异更大。</li> </ul> <p>其成本函数：</p> <div class=arithmatex>\[ J = \sum_{k=1}^{K} \sum_{x_i \in C_k} \| x_i - \mu_k \|^2 \]</div> <ul> <li>初始化：从数据集中随机选择<span class=heti-skip><span class=heti-spacing> </span>K<span class=heti-spacing> </span></span>个点作为聚类中心，记作<span><span class=heti-spacing> </span><span class=arithmatex>\(\mu_{i}\sim\mu_{k}\)</span></span></li> <li>迭代以下步骤：<ul> <li>对每个数据点<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(x_{i}\)</span><span class=heti-spacing> </span></span>计算它到每个聚类中心的欧几里得距离，并将其分配给最近的那个</li> </ul> </li> </ul> <div class=arithmatex>\[ c_i = \arg\min_{k} \| x_i - \mu_k \|^2 \]</div> <ul> <li>找到新的聚类中心</li> </ul> <div class=arithmatex>\[ \mu_k = \frac{1}{|C_k|} \sum_{x_i \in C_k} x_i \]</div> <ul> <li>直到聚类中心不再更新或者达到最大迭代次数</li> <li>改进初始化<ul> <li>进行多次随机的初始化，选择成本函数最低的那个</li> <li>elbow method</li> <li>根据所需<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>课程中以衣服尺码为例子<span><span class=heti-spacing> </span>)</span></li> </ul> </li> </ul> <h2 id=9><span>9<span class=heti-spacing> </span></span>异常检测<a class=headerlink href=#9 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li>建立直觉：它通过分析数据分布、特征之间的关系或使用模型学习正常数据的模式，进而发现不符合这些模式的异常值</li> </ul> <ol> <li>计算均值和方差</li> <li>使用高斯分布建模数据</li> </ol> <div class=arithmatex>\[ p(x_j) = \frac{1}{\sqrt{2\pi\sigma_j^2}} e^{\left(-\frac{(x_j - \mu_j)^2}{2\sigma_j^2} \right)} \]</div> <ol start=3> <li>计算概率</li> </ol> <div class=arithmatex>\[ p(x) = \prod_{j=1}^{n} p(x_j) \]</div> <ol start=4> <li>选择合理的阈值<ul> <li>在验证集上选择<span class=heti-skip><span class=heti-spacing> </span>F1-score<span class=heti-spacing> </span></span>最优的阈值</li> </ul> </li> </ol> <h3 id=91><span>9.1<span class=heti-spacing> </span></span>调整<a class=headerlink href=#91 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h3> <p>有时候数据不符合高斯分布，那么需要对数据进行变换如<span><span class=heti-spacing> </span><span class=arithmatex>\(x_{i}\to\ln{x_{i}}\)</span></span></p> <h2 id=10><span>10<span class=heti-spacing> </span></span>协同过滤<a class=headerlink href=#10 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <p>以电影为例子<br> <span class=arithmatex>\(n_{m}\)</span> 部电影， <span class=arithmatex>\(n_{u}\)</span> 个用户， <span class=arithmatex>\(Y_{ij}\)</span> 表示用户 j 对电影 i 的评分<br> 评分指示矩阵 <span class=arithmatex>\(R_{ij}\)</span> 如果用户 j 评价了电影 i 则值为 1 否则为 0 </p> <ul> <li>成本函数</li> </ul> <div class=arithmatex>\[ J({\mathbf{x}^{(0)},...,\mathbf{x}^{(n_m-1)},\mathbf{w}^{(0)},b^{(0)},...,\mathbf{w}^{(n_u-1)},b^{(n_u-1)}})=\frac{1}{2}\sum_{j=0}^{n_u-1} \sum_{i=0}^{n_m-1}r(i,j)*(\mathbf{w}^{(j)} \cdot \mathbf{x}^{(i)} + b^{(j)} - y^{(i,j)})^2 +\text{regularization} \]</div> <ul> <li>对成本函数梯度下降更新参数来训练模型<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>课程中采用<span class=heti-skip><span class=heti-spacing> </span>tensorflow<span class=heti-spacing> </span></span>库函数实现<span><span class=heti-spacing> </span>)</span></li> <li>推广到二元只需要进行<span class=heti-skip><span class=heti-spacing> </span>sigmoid<span class=heti-spacing> </span></span>的复合，成本函数变换为二元交叉熵即可</li> <li>协同过滤的局限性<ul> <li>数据稀疏时效果不好</li> <li>冷启动问题：新加入的用户没有历史评分数据</li> </ul> </li> <li>归一化解决冷启动问题： <ul> <li><span><span class=arithmatex>\(\tilde{y}(i,j) = y(i,j) - \mu^{(j)}\)</span><span class=heti-spacing> </span></span>其中<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(\mu^{(j)} = \frac{\sum_{i=1}^{n_m} r(i,j) y(i,j)}{\sum_{i=1}^{n_m} r(i,j)}\)</span><span class=heti-spacing> </span></span>预测阶段需加回<span><span class=heti-spacing> </span><span class=arithmatex>\(\mu^{(i)}\)</span></span> </li> </ul> </li> </ul> <h2 id=11_1><span>11<span class=heti-spacing> </span></span>基于内容的过滤<a class=headerlink href=#11_1 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li>概括：结合物品的特征和用户的特征<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>历史偏好<span class=heti-skip><span class=heti-spacing> </span>)<span class=heti-spacing> </span></span>来推荐</li> <li> <p>下图清晰地展示了训练逻辑<br> <a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250315200031154.png><img alt=image.png src=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/image/20250315200031154.png></a></p> </li> <li> <p><span><span class=arithmatex>\(x_{u}\)</span><span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(x_{m}\)</span><span class=heti-spacing> </span></span>的维度不一定要相同，只需要输出的<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(v_{u}\)</span><span class=heti-spacing> </span></span>和<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(v_{m}\)</span><span class=heti-spacing> </span></span>维度相同</p> </li> <li>成本函数：</li> </ul> <div class=arithmatex>\[ \sum_{(i,j):r(i,j)=1}{(v_{u}^{(j)}\cdot v_{m}^{(i)}-y^{(i,j)})^2}+regularizationterm \]</div> <ul> <li>从大型目录中推荐<span class=heti-skip><span class=heti-spacing> </span>:<span class=heti-spacing> </span></span>先检索<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>找最相关<span class=heti-skip><span class=heti-spacing> </span>)<span class=heti-spacing> </span></span>再排序</li> </ul> <h2 id=12_1><span>12<span class=heti-spacing> </span></span>强化学习<a class=headerlink href=#12_1 title="Permanent link"><span><span class=heti-spacing> </span>¶</span></a></h2> <ul> <li> <p>建立直觉：设定某种反馈机制，不断尝试不同的动作，通过反馈结果来改进决策，从而找到最优决策</p> </li> <li> <p>贝尔曼方程<span class=heti-skip><span class=heti-spacing> </span>(MDP<span class=heti-spacing> </span></span>的思想<span><span class=heti-spacing> </span>)</span></p> </li> </ul> <div class=arithmatex>\[ Q_{i+1}(s,a) = R + \gamma \max_{a'}Q_i(s',a') \]</div> <ul> <li>对<span class=heti-skip><span class=heti-spacing> </span>Lunar lander<span class=heti-spacing> </span></span>的概括：随机初始化神经网络中的每一组<span class=heti-skip><span class=heti-spacing> </span>w<span class=heti-spacing> </span></span>和<span><span class=heti-spacing> </span>b</span>，使降落器随机运动，存储<span class=heti-skip><span class=heti-spacing> </span>10000<span class=heti-spacing> </span></span>组数据，制作成输入<span class=heti-skip><span class=heti-spacing> </span>-<span class=heti-spacing> </span></span>标签对，然后训练神经网络。其中贝尔曼方程的第二项是由神经网络预测的。这种训练方法被称为 <strong><span>DQN<span class=heti-spacing> </span></span>算法</strong> (Deep Q Network)</li> <li>在创建数据的时候采用一种更科学的方式———— <span><span class=arithmatex>\(\epsilon\)</span> -<span class=heti-spacing> </span></span>贪心算法：以一个小概率<span class=heti-skip><span class=heti-spacing> </span>ϵ<span class=heti-spacing> </span></span>选择一个随机的动作进行探索，而以<span class=heti-skip><span class=heti-spacing> </span>1- <span class=arithmatex>\(\epsilon\)</span><span class=heti-spacing> </span></span>的概率进行回报最大的探索。<ul> <li>合理性：防止了局部最优，意思是可能导致永远不会探索到某个有可能引发好结果的动作</li> <li>一般采用逐步减小<span class=heti-skip><span class=heti-spacing> </span><span class=arithmatex>\(\epsilon\)</span><span class=heti-spacing> </span></span>的做法</li> </ul> </li> </ul> <p>关于<span class=heti-skip><span class=heti-spacing> </span>DNQ<span class=heti-spacing> </span></span>的一些理解：</p> <ul> <li>如果状态值是离散的，那么<span class=heti-skip><span class=heti-spacing> </span>Q<span class=heti-spacing> </span></span>学习可以通过遍历每个状态和动作来更新<span class=heti-skip><span class=heti-spacing> </span>Q<span class=heti-spacing> </span></span>的值，但是如果状态时连续的，这个过程就不可行</li> <li>所以引入了<span><span class=heti-spacing> </span>DNQ</span> ，通过训练神经网络来使得输出的<span class=heti-skip><span class=heti-spacing> </span>Q (s, a)<span class=heti-spacing> </span></span>尽可能最优</li> <li>由于每次更新<span class=heti-skip><span class=heti-spacing> </span>Q<span class=heti-spacing> </span></span>网络时，目标项<span class=heti-skip><span class=heti-spacing> </span>y<span class=heti-spacing> </span></span>依赖于当前网络的输出<span><span class=heti-spacing> </span><span class=arithmatex>\(Q(s^{'},a^{'};w)\)</span></span> ，所以成本函数的标签和预测值都在变化，可能会不稳定<span class=heti-skip><span class=heti-spacing> </span>(<span class=heti-spacing> </span></span>我也不太理解这里的不稳定<span><span class=heti-spacing> </span>)</span></li> <li>于是引入目标网络，目标网络的参数只有经过一定的步长才会更新，并且采用<strong>软更新</strong>的方式， <span><span class=arithmatex>\(w^-\leftarrow \tau w + (1 - \tau) w^-\)</span><span class=heti-spacing> </span></span>这样可以使更新变得更平滑。</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2025年3月20日 15:53:25</span> </span> <span class=md-source-file__fact> <span class=md-icon title=创建日期> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2025年3月9日 23:18:15</span> </span> </aside> <div id=__comments></div> <!-- <h3>颜色主题调整</h3>
    <div class="tx-switch">
    <button class="button1" data-md-color-primary="red" style="background-color:red">red</button>
    <button class="button1" data-md-color-primary="pink" style="background-color:pink;color:black">pink</button>
    <button class="button1" data-md-color-primary="purple" style="background-color:purple">purple</button>
    <button class="button1" data-md-color-primary="indigo" style="background-color:indigo">indigo</button>
    <button class="button1" data-md-color-primary="blue" style="background-color:blue">blue</button>
    <button class="button1" data-md-color-primary="cyan" style="background-color:cyan;color:black">cyan</button>
    <button class="button1" data-md-color-primary="teal" style="background-color:teal">teal</button>
    <button class="button1" data-md-color-primary="green" style="background-color:green">green</button>
    <button class="button1" data-md-color-primary="lime" style="background-color:lime;color:black">lime</button>
    <button class="button1" data-md-color-primary="orange" style="background-color:orange;color:black">orange</button>
    <button class="button1" data-md-color-primary="brown" style="background-color:brown;border-radius=3px">brown</button>
    <button class="button1" data-md-color-primary="grey" style="background-color:grey">grey</button>
    <button class="button1" data-md-color-primary="black" style="background-color:black">black</button>
    <button class="button1" data-md-color-primary="white" style="background-color:white;color:black">white</button>
    </div> --> <!-- Giscus --> <script async crossorigin=anonymous data-category=Announcements data-category-id=DIC_kwDONhXY184ClgKT data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-mapping=pathname data-reactions-enabled=1 data-repo=Auzers/notes data-repo-id=R_kgDONhXY1w data-strict=0 data-theme=preferred_color_scheme src=https://giscus.app/client.js>
</script> <script>
    var buttons = document.querySelectorAll("button[data-md-color-primary]")
    buttons.forEach(function (button) {
        button.addEventListener("click", function () {
            var attr = this.getAttribute("data-md-color-primary")
            document.body.setAttribute("data-md-color-primary", attr)
            localStorage.setItem("data-md-color-primary", attr);
        })
    })
</script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")
</script> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"
        giscus.setAttribute("data-theme", theme)
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate" ? "dark" : "light"

                /* Instruct Giscus to change theme */
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component=top hidden type=button> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2024 - Present <a href=https://github.com/Auzers/ rel=noopener target=_blank>Auzers</a> </div> Powered by <a href=https://www.mkdocs.org/ rel=noopener target=_blank> MkDocs </a> with theme <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material </a> <!-- modified by
      <a href="https://github.com/WncFht" target="_blank" rel="noopener">
        WncFht
      </a> --> </div> <div class=md-social> <a class=md-social__link href=https://github.com/Auzers rel=noopener target=_blank title=GitHub> <svg viewbox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a class=md-social__link href=https://cdn.jsdelivr.net/gh/Auzers/drawingbed/wechat_code.jpg rel=noopener target=_blank title=WeChat> <svg viewbox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.action.view", "content.footnote.tooltips", "content.tabs.link", "header.autohide", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top", "navigation.path", "toc.follow", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../../assets/javascripts/bundle.88dd0f4e.min.js></script> <script src=../../../js/katex.min.js></script> <script src=../../../js/mathjax.min.js></script> <script src=../../../js/tablesort.js></script> <script src=../../../js/toc.min.js></script> <script src=https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/extra.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml-full.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-svg-full.js></script> <script>document.addEventListener('DOMContentLoaded', () => {
    let attempts = 0;
    const maxAttempts = 50;

    const waitForNav = setInterval(() => {
        attempts++;
        const nav = document.querySelector('.md-sidebar--secondary .md-nav__list');
        if (!nav) return;

        const navItems = Array.from(nav.querySelectorAll('.md-nav__item'));
        if (navItems.length === 0) {
            if (attempts >= maxAttempts) {
                clearInterval(waitForNav);
                console.error('目录加载超时');
            }
            return;
        }

        clearInterval(waitForNav);
        console.log('目录项数量:', navItems.length);

        // 获取主内容区域
        const mainContent = document.querySelector('.md-content__inner');
        if (!mainContent) return;

        // 获取所有标题
        const headings = Array.from(mainContent.querySelectorAll('h1, h2, h3, h4, h5, h6'));
        console.log('标题数量:', headings.length);

        // 收集所有分隔线位置
        const walker = document.createTreeWalker(mainContent, NodeFilter.SHOW_TEXT, {
            acceptNode: (node) => {
                if (!node || !node.textContent) return NodeFilter.FILTER_REJECT;
                if (node.parentElement?.closest('pre, code, .md-nav, script, style')) {
                    return NodeFilter.FILTER_REJECT;
                }
                return NodeFilter.FILTER_ACCEPT;
            }
        }, false);

        const hrPositions = [];
        let node;
        while (node = walker.nextNode()) {
            const text = node.textContent.trim();
            const match = text.match(/^---(.+?)---$/);
            if (match) {
                hrPositions.push({
                    node,
                    content: match[1].trim()
                });
            }
        }

        // 处理每个分隔线
        hrPositions.forEach((hrData, index) => {
            // 创建分隔线
            const hr = document.createElement('hr');
            hr.setAttribute('data-content', hrData.content);
            hr.classList.add('custom-hr');
            hr.id = `hr-${index + 1}`;
            hrData.node.parentNode.replaceChild(hr, hrData.node);

            // 创建目录项
            const li = document.createElement('li');
            li.classList.add('md-nav__item', 'hr-nav-item');
            const a = document.createElement('a');
            a.classList.add('md-nav__link');
            a.href = `#hr-${index + 1}`;
            a.textContent = `${hrData.content}`; // 修改这里，添加前后的破折号
            li.appendChild(a);



            // 找到分隔线后的第一个标题
            let nextHeadingIndex = -1;
            for (let i = 0; i < headings.length; i++) {
                const heading = headings[i];
                if (hr.compareDocumentPosition(heading) & Node.DOCUMENT_POSITION_FOLLOWING) {
                    nextHeadingIndex = i;
                    break;
                }
            }

            console.log('分隔线:', hrData.content, '下一个标题索引:', nextHeadingIndex);

            if (nextHeadingIndex !== -1) {
                // 找到对应的目录项
                const nextHeading = headings[nextHeadingIndex];
                const nextNavItem = navItems.find(item => {
                    const link = item.querySelector('a');
                    const text = link?.textContent?.replace('¶', '').trim();
                    return text === nextHeading.textContent.replace('¶', '').trim();
                });

                if (nextNavItem) {
                    nav.insertBefore(li, nextNavItem);
                    console.log('插入到标题前:', nextHeading.textContent);
                    return;
                }
            }

            nav.appendChild(li);
            console.log('追加到末尾:', hrData.content);
        });
    }, 100);
});</script><script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>